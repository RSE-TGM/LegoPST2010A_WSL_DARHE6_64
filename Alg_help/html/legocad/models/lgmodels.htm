<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>lgmodels</TITLE>
<META NAME="Template" CONTENT="C:\Microsoft Office\Office\html.dot">
</HEAD>
<BODY>

<B><FONT FACE="Arial, helvetica" SIZE=6><P ALIGN="JUSTIFY"><A NAME="lg_model_main">LEGO simulation models</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="JUSTIFY"><A HREF="#lg_model_intro"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">What is a LEGO model?</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_model_advant"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Advantages of LEGOCAD System in process simulation</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_model_building"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Steps to be performed in process model building</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_model_example"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Example of a LEGO model building</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_model_transient"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Transients simulation</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test1"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 1 - "ANELLO"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test2"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 2 - "ARIAGAS"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test3"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 3 - "CCOMB"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test4"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 4 - "COND"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test5"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 5 - "POMPE"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test6"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 6 - "TURBINA"</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgtestc0.htm#lg_model_test7"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test case 7 - "TURBOGAS"</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
<P>&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_intro"></A>What is a lego model?</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">A LEGO model is the simulation model of a particular part of a plant which is performed using the LEGOCAD System and the LEGO process libraries (including LEGOCAD standard and user-defined libraries).</P>
<P ALIGN="JUSTIFY">Models which can be simulated using LEGOCAD System can be divided into four different groups:</P>
<P ALIGN="JUSTIFY">1)&#9;process models</P>
<P ALIGN="JUSTIFY">2)&#9;regulation models</P>
<P ALIGN="JUSTIFY">3)&#9;mixed models</P>
<P ALIGN="JUSTIFY">4)&#9;non-Lego models</P>
<P ALIGN="JUSTIFY">Process models are the LEGO models described in this documentation. They are models which simulate the dynamical behaviour of a (small) plant, a part of a plant or a component of a plant.</P>
<P ALIGN="JUSTIFY">LEGO models are very often devoted to the simulation of thermo-electrical power plants, as LEGOCAD System has been developed by the Automation Research Centre of the Italian National Electric Company, but also other kind of processes have been succesfully simulated using LEGOCAD System, in the following fields:</P>
<P ALIGN="JUSTIFY">robotics</P>
<P ALIGN="JUSTIFY">magneto-hydrodinamics</P>
<P ALIGN="JUSTIFY">power electronics</P>
<P ALIGN="JUSTIFY">fuel cells</P>
<P ALIGN="JUSTIFY">iron mill strip plants</P>
<P ALIGN="JUSTIFY">water and gas distribution networks</P>
<P ALIGN="JUSTIFY">Regulation models are simulation models of regulation, control and automation systems; they are almost always used in parallel with process models to fully simulate the actual behaviour of a plant or a part of a plant. Stand-alone regulation model are less used, as a stand-alone regulation model requires the user to evaluate the actual behaviour of the process part of the plant.</P>
<P ALIGN="JUSTIFY">Particular cases of stand-alone regulation models are models directly interfaced with the process (and not with a simulated process as usual); in this case one shouldn't call them "regulation models" but "LEGOCAD regulations" as LEGOCAD models are directly used to perform the plant control functions. They are mainly used for high-level control and advanced supervisor functions.</P>
<P ALIGN="JUSTIFY">Mixed models are models in witch both the process and its regulation are simulated. They are used only for small plants (or small parts of bigger plants) as they require that both the process model and the regulation model are so simply to allow the user put them together in only one simulation model. No other advantage is given to the simulation in mixing process and regulation systems, as the process and the regulation parts of the model are nevertheless differently simulated by LEGOCAD System, exactly as they were in two different models.</P>
<P ALIGN="JUSTIFY">Non-LEGO models are external programs, which input/output interface has been modified to allow them join within LEGOCAD System to process and regulation models. Particular cases of non-LEGO models are phisical process components or external control systems which are seen by LEGOCAD System as external processes (the only task of these processes is the interface between LEGOCAD and the component or the control system).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=5 COLOR="#ffffff"><P>&nbsp;</P>
</FONT><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_advant">Advantages of LEGOCAD System in process simulation</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The most usual purpose of the mathematical model of a system is to study the behaviour of the system itself consequently to perturbations of its boundary conditions.</P>
<P ALIGN="JUSTIFY">Using a modular simulation system (like LEGOCAD System) the approach to the carrying out of a system model is the following:</P>
<P ALIGN="JUSTIFY">1)&#9;to separate the system into its single components, with the purpose of building a single mathematical model for each &#9;component of &#9;the system;</P>
<P ALIGN="JUSTIFY">2)&#9;to study the physical phenomena taking part in each component of the system;</P>
<P ALIGN="JUSTIFY">3)&#9;to choose for each component the interesting phenomena for the simulation and to represent them by mathematical equations;</P>
<P ALIGN="JUSTIFY">4)&#9;to put together the mathematical models of all the components of the system.</P>
<P ALIGN="JUSTIFY">The first advantage of the LEGOCAD System for mathematical models building is that it allows the construction of a system model according to the previous scheme; the mathematical connection between the models of each component are automatically build by LEGOCAD System according to the topological connections assigned by the user.</P>
<P ALIGN="JUSTIFY">The mathemathical model of a component may be used more than once in each model (as many times as the user need it). LEGOCAD System automatically modifies the variables set of each istance of that mathematical model to make the system correctly simulate every component.</P>
<P ALIGN="JUSTIFY">The mathematical model (LEGO simulation module) of a component may be built (and should be built) in a parametric way, to let it be used to simulate a very large set of component of that kind (e.g.: valves, pipes, exchangers, …). So it is possible to build a library of mathematical models (LEGO modules) which may be used later for the building of other models.</P>
<P ALIGN="JUSTIFY">The most important advantage of LEGOCAD System is given by its libraries of fully tested and documented modules, which greatly simplify the building of the LEGO models of the following kinds of plant (or plant subsystems):</P>
<P ALIGN="JUSTIFY">foxil fuel thermo-electrical power plants</P>
<P ALIGN="JUSTIFY">nuclear thermo-electrical power plants</P>
<P ALIGN="JUSTIFY">gas turbine and combined cycle power plants</P>
<P ALIGN="JUSTIFY">oil, gas and coal fuel supply systems</P>
<P ALIGN="JUSTIFY">compressed air auxiliary systems</P>
<P ALIGN="JUSTIFY">air and flue gas subsystems</P>
<P ALIGN="JUSTIFY">These kinds of plant (and plant subsystems) will be furthermore called "standard processes" which means that they can be fully (or almost fully) simulated using only library LEGO modules.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P ALIGN="JUSTIFY"><A NAME="lg_model_building">Step to be performed in process model building</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">1)&#9;</FONT><A HREF="#lg_model_gendata"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Plant analysis and general data requirement</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">2)&#9;LEGOCAD process libraries checking:</P>
<P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_typical"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">typical plants</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_libraries"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">modules libraries</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_lumped"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">lumped parameters and cellized modules</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">3)&#9;</FONT><A HREF="#lg_model_userlib"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">User library building (if needed)</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">4)&#9;Module set choice:</P>
<P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_phenom"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">simulated phenomena</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_blocks"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">blocks and components</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_obsolete"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">obsolete modules</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_in_out"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">input and output variables</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_rules"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">input/output connection rules</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_connectivity"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">modules connectivity</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_conn_prob"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">example: a connectivity problem</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">5)&#9;</FONT><A HREF="#lg_model_specdata"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Specific data requirement</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">6)&#9;Model topology building:</P>
<P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_stepbystep"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">"step-by-step" building</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_topology"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">topology building</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_macroblocks"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">topological scheme (macroblocks)</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_blonames"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">blocks names and descriptions</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_varnames"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">variables names and descriptions</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_sample1"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">example 1: manifold and valves</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_sample2"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">example 2: steam turbine</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_sample3"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">example 3: pump and exchanger</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">7)&#9;Model data and variables assignment:</P>
<P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_dat_ass"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">phisical and geometrical data</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_var_ass"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">model variables assignment</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_known"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">known and unknown variables</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_selnoti"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">known variables selection</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">8)&#9;Steady state computation phase:</P>
<P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_steady"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">steady state computation</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_failure"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">computation failures</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&#9;</FONT><A HREF="#lg_model_success"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">computation success</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">9)&#9;</FONT><A HREF="#lg_model_testran"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test transients simulation</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY"><A NAME="b"></A>Note:&#9;actions number 6, 7 and 8 have to be performed cyclically "step-by-step" (a few number of blocks a time); sometimes also step 9 (test transients) may be performed to check model coherency; for each set of blocks all actions should be performed until complete model building is done.</P><DIR>
<DIR>

</FONT><B><FONT FACE="Arial, helvetica" SIZE=5 COLOR="#ffffff"><P>&nbsp;</P></DIR>
</DIR>

</FONT><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_gendata">Plant analysis in process model building</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The first step for the construction of a simulation model is to specify the purpose of the model itself: the complexity of a mathematical model depends from which phenomena are interesting for the simulation.</P>
<P ALIGN="JUSTIFY">The system has to be separated into its physical components. The model maker has to decide which of these components will be represented in the model, according to the purpose of the simulation: if a component doesn't perform any significant function during the simulations of interest, it will not be represented in the model.</P>
<P ALIGN="JUSTIFY">For instance, in a thermo-hydraulical plant, the model maker can decide not to model the safety valves, if the purpose of the model is to represent the behaviour of the plant near to the design conditions (in this working range the safety valves don't perform any function). On the contrary, safety valves has to be simulated if the purpose of the model includes malfunctioning simulation, alarm detection and recovery or startup and shutdown procedures.</P>
<P ALIGN="JUSTIFY">During plant analysis, model maker should begin to collect plant general data like:</P>
<P ALIGN="JUSTIFY">plant drawings</P>
<P ALIGN="JUSTIFY">P. &amp; I. diagrams</P>
<P ALIGN="JUSTIFY">thermal balances</P>
<P ALIGN="JUSTIFY">pipelines isometrics</P>
<P ALIGN="JUSTIFY">components specific data</P>
<P ALIGN="JUSTIFY">operating and control strategies</P>
<P ALIGN="JUSTIFY">plant behaviour (experimental data)</P>
<P ALIGN="JUSTIFY">Several of these data will not be directly useful in this working phase, and maybe they are not actually obtainable (experimental data can be taken only on existing plants, many items may be considered industrial secrets or professional secrecy and so on). Nevertheless every datum is a knowledge bit which will help the model maker to get a better model.</P>
<P ALIGN="JUSTIFY">In this phase many data can be uset to choose which phenomena and which components have to be simulated. The model maker must do his best to reduce the number of simulated components and simulated phenomena, to get a simplier, easier to use and faster to run model; in the meantime he must not cut off the simulation of components and phenomena whose behaviour is important for the simulation targets. Only a good knowledge of the pland and the working conditions to be simulated can allow the model maker to get the best choice.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_typical">LEGOCAD libraries: typical plants</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The second step to perform when one wants to simulate a plan or a a part of a plant with LEGOCAD System is to check if the kind of process he wants to simulate is a "standard process":</P>
<P ALIGN="JUSTIFY">foxil fuel thermo-electrical power plants</P>
<P ALIGN="JUSTIFY">nuclear thermo-electrical power plants</P>
<P ALIGN="JUSTIFY">gas turbine and combined cycle power plants</P>
<P ALIGN="JUSTIFY">oil, gas and coal fuel supply systems</P>
<P ALIGN="JUSTIFY">compressed air auxiliary systems</P>
<P ALIGN="JUSTIFY">air and flue gas subsystems</P>
<P ALIGN="JUSTIFY">If the plant (or the system) to be simulated is not in this set, probably the model maker will have first to build its own process module library, checking LEGOCAD System libraries to find if any existing module can be used (of easily modified) for his purposes.</P>
<P ALIGN="JUSTIFY">In the other case he has to check if actually the LEGOCAD System libraries modules can fully simulate the plant with the desired level of complexity: note that at the moment LEGOCAD libraries are mainly devoted to real-time simulation. So very fast dynamical phenomena aren't usually taken into account: if the model maker wants to simulate these kind of phenomenon, he will still have to build its own module library.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_libraries">Process models simulated by LEGO libraries</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">In LEGOCAD System four process libraries are present:</P>
</FONT><P ALIGN="JUSTIFY"><A HREF="../lib_proc/lglibpro.htm#lg_libproc_term"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Thermodynamic base library</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="../lib_proc/lglibpro.htm#lg_libproc_aux"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Auxiliary systems library</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY">LEGO library modules can simulate a very large set of process components:</P>
</FONT><P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_valves"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Valves and pumps</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_wscavi"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Water and steam cavities, manifolds and mixers</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_wspipe"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Water and steam pipes, exchangers and evaporators</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_conds"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Steam condensers, deareators and cooling towers</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_ccsteam"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Combustion chambers for steam generators</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_metals"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Flue gas side and metal wall of pipes and exchangers</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_turb"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Steam turbines and related modules</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_tg"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Turbogas plants and related modules</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_airflue"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Air and flue gas system components</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_air"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Compressed air and natural gas treatment</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_stress"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Stress analysis in steam plant components</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_auxmod"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Auxiliary modules (used to connect other modules)</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_impreg"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Implicit regulators</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_proclib_fuelsupp"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Fossil fuel supply systems for steam generators</U></FONT></A></P>
<P><A HREF="../lib_proc/lglibpro.htm#lg_libproc_kinelec"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Electrical modules</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P>&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_lumped">Lumped parameters and cellized modules</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGOCAD can solve only these two different kind of equations:</P>
<P ALIGN="JUSTIFY">ordinary differential equations;</P>
<P ALIGN="JUSTIFY">algebraic closed-form equations (linear or non-linear).</P>
<P ALIGN="JUSTIFY">Continuous differential equations and partial derivatives equations can't be solved by the LEGOCAD System mathematical solutor. The mathematical-phisical model of continuous systems must be converted in a "lumped parameters" form.</P>
<P ALIGN="JUSTIFY">Continuous differential equations and partial derivatives equations can be solved in a LEGO model in two different ways:</P>
<P ALIGN="JUSTIFY">directly integrating these equation inside a LEGO module, which must contain not only the equations but also an <I>ad-hoc</I> solver &#9; &#9; (not using the LEGO solver);</P>
<P ALIGN="JUSTIFY">writing these equations in a lumped parameter cellized form, leaving to the LEGO solver the task to integrate the ordinary differential equations system obtained (using the LEGO solver).</P>
<P ALIGN="JUSTIFY">In the LEGOCAD System standard libraries several cellized modules are present. A cellized module is a module whose target is to simulate one or more cells of a continuous component (divided into a certain number of cells, according to lumped parameter theory).</P>
<P ALIGN="JUSTIFY">Two kind of cellized module may be found in LEGOCAD libraries. The easiest kind is a module which can simulate only one cell of the component; as the component will be simulated by several cells, several different blocks will be created in model building phase (one for each cell). The whole component will be simulated by all these block, which have to be correctly connected together and to the rest of the model.</P>
<P ALIGN="JUSTIFY">The second (and more frequent) kind of cellized modules are modules where the only one block may simulate more cells of the component. The usage of this kind of block is more easy than the previous one, as the model maker doesn't have to connect each other all the blocks representing the cells in which the component has been divided.</P>
<P ALIGN="JUSTIFY">As an example, the exchanger model is a cellized model; the model maker has to choose the number of cells for the model. Obviously a model with a lot of cells will ensure a more precise behaviour; on the contrary a few-cell modell will be more fast and more simply. For each cell the temperatures (internal fluid, metal wall and external fluid) and the exchanging coefficents are considered as mean values; so the boundaries between the cells must respect components boundaries (like exchanging parts and not-exchanging parts of the pipe bundle, or parts exchanging with two different external fluids).</P>
<P ALIGN="JUSTIFY">The first kind of modules is used in LEGOCAD libraries only when the number of equations used to simulate each cell is so high that it would be impossible to simulate more cells in one block, due to the maximum number of equations allowed for each LEGO process block (actually 50 equations are allowed for each block in the standard release of LEGOCAD System).</P>
<P ALIGN="JUSTIFY">An example of this kind of module is the Ljungst&ouml;m air preheater. This component is usually simulated using two or three cells (depending on the component lenght); the model maker has to create two or three different blocks and to properly connect them together.</P>
<P ALIGN="JUSTIFY">Also for the second kind of modules, the maximum number of equation for each module is a limit to the maximum number of cells which can be simulated by one block (it depends on the number of equations required for the simulation of each cell). If the maximum number of cells is too small, two or more blocks can be created, and they will be connected together to wholly simulate the component (the total number of cells will be equal to the sum of the numbers of cells simulated by each block).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT SIZE=5 COLOR="#ffffff"><P>&nbsp;<A NAME="lg_model_userlib"></FONT><FONT FACE="Arial, helvetica" SIZE=6>How to build an user module library</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">After having selected the components that have to be represented in the model, the model maker has to separate the components to be simulated into different classes of similar components. Each class of component must contain only components which may be simulated by the same mathematical model, which will be simulated by the related user LEGO module.</P>
<P ALIGN="JUSTIFY">The model maker must accurately study the physical phenomena taking part in each kind of component: he will decide to represent only the phenomena of interest for the simulation. Each phenomenon can be described by algebraic or differential equations.</P>
<P ALIGN="JUSTIFY">The mathematical approach to each problem depends from many variables, as the time constant and the space evolution of the process that has to be represented. Generally the model maker has to follow some simple rules:</P>
<P ALIGN="JUSTIFY">1)&#9;usually the process is represented by partial differential equations in (x,y,z,t). As the LEGO equations solver allows only the resolution &#9;of non linear first order differential equations in the time, the model maker has to operate a monodimensional discretization of the &#9;process and he has to use mean variables to represent the process time evolution;</P>
<P ALIGN="JUSTIFY">2)&#9;if the time constant of a process is much lower than the time constants of the other processes involved in the model, the model maker &#9;can decide not to represent the dynamical evolution of this process and therefore to describe it by algebraic equations. For instance, &#9;in the valves of a thermo-hydraulical plant, the mass and energy storages are negligible, so the fluid flow in a valve can be evaluated &#9;by an algebraic equation;</P>
<P ALIGN="JUSTIFY">3)&#9;the validity of the equations representing a process is usually limited to a specific range: the equations must be "protected" to avoid &#9;numerical problems (for instance divisions by zero or square roots of negative values).</P>
<P ALIGN="JUSTIFY">&#9;After having completed the previous studies about the system components, the model maker has to build new LEGO modules. &#9;Usually a LEGO module represent the behaviour of a single component of a system, but it can also represent more components &#9;interacting or only a part of a component (which will be simulated by more modules). The construction of a LEGO module is based on &#9;few simple rules:</P>
<P ALIGN="JUSTIFY">1)&#9;the model maker has to write the differential-algebraic equations system representing the component processes;</P>
<P ALIGN="JUSTIFY">2)&#9;the parameters of these equations must be divided into three categories:</P>
<P ALIGN="JUSTIFY">a)&#9;"output variables": their value is obtained by solving the equations; if an output variable is the solution of a time differential equation it &#9;is called "state output variable", if it is the solution of an algebraic equation it is called "algebraic output variable";</P>
<P ALIGN="JUSTIFY">b)&#9;"input variables": they represent the boundary conditions of the equations; their value conditions the value of the output variables and &#9;it can change during the simulation;</P>
<P ALIGN="JUSTIFY">c) &#9;"geometrical and physical data": these parameters are constants (they can't change during simulation) that characterize the geometry &#9;and the physical characteristics of a component. For instance, a tube is characterized by the outside and the inside diameter, by the &#9;length and by the physical characteristics of the material such as density, thermal capacity and conductivity.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_phenom">How to choose LEGO library modules: simulated phenomena</A></P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">For each kind of component the user must analize the list of library modules which simulates that component.</P>
<P ALIGN="JUSTIFY">As first the model maker has to get sure that into LEGOCAD libraries he can actually find a simulation module which simulates all the phenomena he wants to take into account for these kind of components. If no library module simulates the components at the desired level of accuracy, the model maker has to build a new module which will take into account all the required phenomena: in most cases he can do it modifying (expanding) the existing library modules (the only other way is to reduce the desired level to the actual libraries one).</P>
<P ALIGN="JUSTIFY">If the expansion is a general-purpose expansion, the standard libraries may get relief of this improvement. New modules developers and modules expanders are always suggested to relate their work to the LEGOCAD libraries maintenance responsible: maybe next model makers will get help from their work, and maybe they get useful advices.</P>
<P ALIGN="JUSTIFY">Sometimes the model maker can use library modules which don't simulate all the phenomena he wants to simulate, but it needs that the phenomena which are simulated are actually simulated whith the right accuracy, and that the non simulated phenomena have no or negligible influence on the simulated phenomena. In this case he can add another model (using a new user process module) to simulate the other required phenomena.</P>
<P ALIGN="JUSTIFY">To perform this step, the model maker should read the documentation of the existing libraries modules: card "A" of the standard documentation of each module is devoted to the description of the function performed by the module (including the model simplifications assumed by the module developer).</P>
<P ALIGN="JUSTIFY">A brief description of the libraries modules is given into this documentation in the sections related to the sets of modules simulating the different kinds of plant components.</P>
<P ALIGN="JUSTIFY">Also the model maker should try to choose modules which simulates only the interesting phenomena in each kind of component: he will so obtain a simplier and faster simulation model. Sometimes, if he wants to perform a very easy representation of a part of a plant, he can choose to build itself a simplified module, simulating only the relevant phenomena he wants to take into account.</P>
<P ALIGN="JUSTIFY">The easiest way to simulate a plant subsystem, when its internal working strategy is unuseful for the simulation target, is to simulate the subsystem as a "black-box": the model only will evaluate the external behaviour of the subsystem according to the input values. Such kind of models are called "transfert function models". The two more-used kind of "black-box" models are look-up tables and neural networks.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_blocks"></A>Blocks and components correlation</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">As previously described (about lumped parameters and cellized modules) it may happen that one component has to be simulated by several LEGO process blocks.</P>
<P ALIGN="JUSTIFY">In case of a cellized component, the component will be simulated by only one block if there is a LEGO module which can simulate the required number of cells; on the contrary the component will be simulated by several blocks (if the related module can't simulate the required number of cells with one block or it can simulate only one cell for each block).</P>
<P ALIGN="JUSTIFY">An opposite example can be given about series of valves. Sometimes a sequence of valves is present on a straight pipe (as an example a stop valve, a regulation valve and a check valve are often present on the same branch). In most cases the mass and energy storage between the valves can be neglected (or assimilated to the nearest manifold) and there is no reason to simulate the whole pipe inserting a pressure node between each couple of valves.</P>
<P ALIGN="JUSTIFY">The best solution is to simulate these three valves with one only block, whose equivalent discharge characteristic curve will be obtained joining the data of the real valves. In the case of a series of valves, a devoted module (the VACT module) has been developed to evaluate the equivalent stem position in function of the stem position of the stop and the regulating valve (assuming the check valve has no external actuation). The VACT module may also be used for the actuation of isolated valves, three way valves, parallel arrangement valves and authomatic (mechanical) pressure reduction valves.</P>
<P ALIGN="JUSTIFY">The second example given is also an example of a not-direct block-component relation: three component (the stop valve, the regulation valve and the check valve) are simulated by two blocks (the equivalent valve behaviour and the equivalent stem position evaluation blocks). As one can easily see, no prescription is given by LEGOCAD System about the correspondance between blocks and components. In most cases the model maker will use one module to simulate each component because often this is the easiest and the usefullest solution, but he is not obliged to (it is only a model maker choice).</P>
<P ALIGN="JUSTIFY">Note that the boundary of the part of plant simulated by a block has not to be an actual component boundary. As an example, a pipe joining two manifolds can be divided into two parts and simulated by the two manifolds. The phisical and geometrical data of the manifolds will be modified to take into account the volume, the metal mass and the external exchanging surface of the pipe. In this case, the boundary of the part of plant simulated by each manifold is in a certain point of the pipe, not corresponding to any plant component boundary.</P>
<P ALIGN="JUSTIFY">As the energy and mass storage is elsewhere simulated, the fluid flow rate flow rate throwing the pipe can be simulated with a simplified head loss module (the TUBO module). In this case one sees that the pipe is partially simulated by a devoted module and partially in other two modules (whose main task is to simulate other plant components, but whose have been modified to take into account the two halfs of the pipe).</P>
<P ALIGN="JUSTIFY">All these examples are given to impress on readers minds that <B>no prescription</B> is given by LEGOCAD System about the correspondance between blocks and components.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_obsolete"></A>How to choose LEGO library modules: obsolete modules</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGOCAD standard libraries are continually mantained to expand and improve the capabilities of the modules.</P>
<P ALIGN="JUSTIFY">To mantain the compatibility whith the previous model, everywhen a module is substantially modified the previous release is still kept (with its original name), and the new release is inserted into the library with another name (like it were a new original module). The old module will be removed only later, when it will be actually no more used.</P>
<P ALIGN="JUSTIFY">Many obsolete modules are so present inside the standard libraries of LEGOCAD System, and they insure the compatibility with all the existing plant simulators.</P>
<P ALIGN="JUSTIFY">When a not-skilled model maker has to build a new model, he must read libraries documentation to check which is the newest release of each kind of module, and he must use only those newest modules. Obsolete modules shouldn't be ever used in new models, as they are not still mantained (obsolete modules are cleanly indicated in this documentation).</P>
<P ALIGN="JUSTIFY">Only in a very unusual case he may use old releases: when the newest release don't replies every feature of the old module, and only if at least one of the not-replied features really has to be used in the model. Also the model maker should try to check if there is another way (which wouldn't require the not-replied features) to build the model.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_in_out"></A>Input and output variables of a LEGO module</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The choice of the input and the output variables must not be random: the model maker must take into account that the modules must be interconnected.</P>
<P ALIGN="JUSTIFY">Output variables of a module can be connected with input variables of another module with the purpose of building the topology of the system model. Output and input variables of a module may not correspond to physical output and input variables of the component represented by the module. The following example shows what is the meaning of this sentence.</P>
<P ALIGN="JUSTIFY">In a generic concentrated head loss the fluid flow rate depends from many parameters, such as inlet and outlet fluid pressure. The equation representing this phenomenon can be written in following way:</P>
<P ALIGN="CENTER">f(p</FONT><FONT FACE="Arial, helvetica" SIZE=1>i</FONT><FONT FACE="Arial, helvetica">, p</FONT><FONT FACE="Arial, helvetica" SIZE=1>u</FONT><FONT FACE="Arial, helvetica">, W) = 0</P>
<P ALIGN="JUSTIFY">p</FONT><FONT FACE="Arial, helvetica" SIZE=1>i </FONT><FONT FACE="Arial, helvetica">= inlet pressure</P>
<P ALIGN="JUSTIFY">p</FONT><FONT FACE="Arial, helvetica" SIZE=1>u</FONT><FONT FACE="Arial, helvetica"> = outlet pressure</P>
<P ALIGN="JUSTIFY">W = fluid flow rate</P>
<P ALIGN="JUSTIFY">The model maker can build three different modules based on the same equation:</P>
</FONT><P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="CENTER"><IMG SRC="image4.gif" WIDTH=435 HEIGHT=186></P>
<P ALIGN="CENTER">&nbsp;</P>
<P ALIGN="CENTER"><IMG SRC="image5.gif" WIDTH=435 HEIGHT=186></P>
<P ALIGN="CENTER">&nbsp;</P>
<P ALIGN="CENTER"><IMG SRC="image6.gif" WIDTH=435 HEIGHT=186></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Are all these three solution feasible?</P>
<P ALIGN="JUSTIFY">If the head loss is not in the sonic working range, the value of the function f(p</FONT><FONT FACE="Arial, helvetica" SIZE=1>i</FONT><FONT FACE="Arial, helvetica">, p</FONT><FONT FACE="Arial, helvetica" SIZE=1>u</FONT><FONT FACE="Arial, helvetica">, W) value actually depends on the value of all these three variables.</P>
<P ALIGN="JUSTIFY">But if the head loss is in the sonic working range (or the model can work both in sonic and non-sonic working ranges) the value does not depend (or does not always depend) on the value of the outlet pressure. In this case the outlet pressure can't be computed by the head loss, as the functioning of the head loss in not influenced by this quantity: in this case only the two other configurations may be used.</P>
<P ALIGN="JUSTIFY">Nevertheless, sometimes such a simulation module can be build and used setting outlet pressure as outlet pressure: in this case, the LEGOCAD system will be able to solve the system only if this "uncomputable" output variable actually has effect on other equations simulated by other modules (in this case, the other modules will actually evaluate head loss outlet pressure value). Obviously, this way to build (and/or to use) modules shouldn't be used (if possible), and such modules can't be used alone (as the output value is actually uncomputable by the module itself). So a module of this kind requires a particular attention to be used: these prescriptions should be widely described in the module documentation.</P>
<P ALIGN="JUSTIFY">The choice between the three (or two) configurations must be based on the possibility of connecting this module with other modules representing other components.</P>
<P ALIGN="JUSTIFY">The LEGOCAD System includes an utility, called "Newmod", that allows the building of a new LEGO module in a very simplified mode: the user has only to specify the number and the name of input and output variables, geometrical and physical data, the equations system and the Jacobian matrix topology (also the Jacobian matrix analytical expression, if he doesn't like to use the numerical Jacobian matrix evaluation procedure), while the "Newmod" program provides to generate the FORTRAN subroutines.</P>
<P ALIGN="JUSTIFY">The equations have to be written in a particular form: for differential equations the LEGOCAD user must assign the expressions of the output state variables derivatives (remember that differential equations must be of the first order), while algebraic equations have to be written in an implicit form (algebraic expression = 0).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_rules"></A>Input and output variables connection rules</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">When the model maker has developed all the single modules representing the components of the system, he can connect them together to build the whole model. The LEGOCAD System provides to make the user's duty easier by a sub-program called "Topology".</P>
<P ALIGN="JUSTIFY">A single module may be defined more than once in the system model with the purpose of representing components described by the same equations. For this reason, when the LEGOCAD user defines a module in the system model, he must assign to it a name that identifies the particular component represented (therefore there's a difference between the "module" name, that identifies a kind of components represented by the same equations, and the "block" name, that identifies the single component of "that system").</P>
<P ALIGN="JUSTIFY">The connections between different blocks are made following these rules:</P>
<P ALIGN="JUSTIFY">1)&#9;output variables of a block can be connected only to input variables of other blocks;</P>
<P ALIGN="JUSTIFY">2)&#9;output variables of a block can't be connected to output variables of other blocks;</P>
<P ALIGN="JUSTIFY">3)&#9;an output variable of a block can be connected to more input variables if they belong to different blocks;</P>
<P ALIGN="JUSTIFY">4)&#9;an output variable of a block can't be connected to more input variables of the same block;</P>
<P ALIGN="JUSTIFY">5)&#9;input variables of a block can't be connected to input variables of other blocks.</P>
<P ALIGN="JUSTIFY">The model maker can perform functions 4 and 5 by using a module of the LEGOCAD process library called DISN. This module provides to copy the value of an input variable in more output variables (the number of the output variables has to be defined by the model maker).</P>
<P ALIGN="JUSTIFY">In this way each output variable of the module DISN can be connected to a different input variables of the other block (or of the other blocks). As all the output variables of the DISN module will assume the same value, also all the input variables connected to these output variables will assume that value.</P>
<P ALIGN="JUSTIFY">When the model topology has been completed, the LEGO Code equations solver "sees" only a differential-algebraic equations system for the whole model; the number of the equations is equal to the total number of the output variables of all the blocks defined in the model.</P>
<P ALIGN="JUSTIFY">The model input variables that haven't been connected with output variables ("free" input variables) represent the boundary conditions of the differential-algebraic system.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_connectivity"></A>How to choose LEGO library modules: variables connectivity</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The choice of LEGO modules which the model maker may use for model building must take into account the input/output schemes of the modules.</P>
<P ALIGN="JUSTIFY">Each plant quantity must be evaluated by one (and only one) block as output variable: the other blocks will read it as input variable, to evaluate other plant quantities. User must choose process modules according to the sets of input and output variables of each module.</P>
<P ALIGN="JUSTIFY">Many modules of the LEGO process module libraries have been developed to allow the LEGOCAD user choose the appropriate topology for them: the input/output scheme may be choosen according to the prescription of the other modules of the model.</P>
<P ALIGN="JUSTIFY">For each kind of "standard process" there is at least one set of modules which can be correctly connected together to perform the simulation of the system. Whenever a set of modules is strictly related (one module can correctly work only connected to a particular set of other modules) this relation is very clearly described both in the module documentation and in process modules abstracs (sometimes it is also included in module description field).</P>
<P ALIGN="JUSTIFY">Note that these relations between modules are often mono-directional (each instance of module A requires an instance of module B to work; module B may be correctly used in connection to other modules, also if module A is not used). This is always true when only one module has been evolved (module C is an evolution of module A; both module A and module C require module B; module B does not require module A, as it can be used with module C).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_conn_prob"></A>An input/output connectivity problem</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">As an example, look at this very easy part of plant:</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image7.gif" WIDTH=449 HEIGHT=178></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY">Assuming that upstream inlet valves and downstream outlet valve there are three unlimited volume reservoirs, the pressures upstream the inlet valves and downstream the outlet valve can be considered as constant.</P>
<P ALIGN="JUSTIFY">Which modules shall one use to simulate this system?</P>
<P ALIGN="JUSTIFY">The only library module for water and steam valves is the VALV module: so there is no doubt about the module to be instanciated to perform the simulation of the valves.</P>
<P ALIGN="JUSTIFY">But VALV module can be invoked in three different ways (don't forget the difference between inlet and outlet, which are process phisical flow directions, and input and output variables, which are only mathematical representations of plant quantities):</P>
<P ALIGN="JUSTIFY">evaluating fluid flow rate (inlet and outlet pressures as input)</P>
<P ALIGN="JUSTIFY">evaluating inlet pressure (outlet pressure and flow rate as output)</P>
<P ALIGN="JUSTIFY">evaluating outlet pressure (inlet pressure and flow rate as output)</P>
<P ALIGN="JUSTIFY">Obviously, as we assumed that the upstream pressures of the inlet valves and the downstream pressure of the outlet valves are constant, inlet valves can't evaluate inlet pressures (which are known) and outlet valve can't evaluate outlet pressure (which is known).</P>
<P ALIGN="JUSTIFY">The problem is still unresolved. How could one choose the right set of input and output variables of each valve?</P>
<P ALIGN="JUSTIFY">The model maker must analize the system and the target of the simulation to choose the most suitable module for the manifold. Only when the module used to simulate the manifold has be choosen one can know the right configurations for valves input and output schemes.</P>
<P ALIGN="JUSTIFY">If the mass and energy storage in the manifold are not negligible, the COLT module is the most suitable. It can also simulate the energy storage in the metal wall of the manifold. Also the COLN module can simulate a manifold, but COLN is an obsolete module (COLT is the new release of the COLN module: COLN doesn't simulate the energy storage in the manifold metal wall).</P>
<P ALIGN="JUSTIFY">The COLT module evaluates among its ouput variables the fluid pressure inside the manifold. As the pressure inside the manifold is the downstream pressure for both the inlet valves and the upstream pressure for the outlet valves, the three VALV modules must evaluate the fluid flow rate along the three branches.</P>
<P ALIGN="JUSTIFY">On the contrary, if the mass and energy storage in the manifold are negligible, it is not useful to use the COLT module: a mixer like MIX2 or MIXN can be used instead of COLT. The MIXN module always evaluates the flow rate and the enthalpy of the fluid at the mixer outlet, so the pressure inside the manifold must be evaluated as upstream pressure of the outlet valve.</P>
<P ALIGN="JUSTIFY">The MIX2 module (two inlet branches) is an old release of MIXN module, which may also evaluate one inlet flow rate as output variable. So the pressure inside the manifold may be evaluated as downstream pressure of one of the inlet valves (the one whose flow rate is evaluated by MIX2).</P>
<P ALIGN="JUSTIFY">The mixer solution is always feasible?</P>
<P ALIGN="JUSTIFY">This solution is always feasible except in one particular working condition: when all the three valves are closed, and no fluid flows incomes to or outgoes from the manifold.</P>
<P ALIGN="JUSTIFY">If a COLT module has been used, the pressure inside the manifold is computed by a differential equation. In this condition, the time derivative of the pressure is null (or depending only on termal exchange therms) and the pressure may be easily computed (it is constant if no thermal exchange occurs).</P>
<P ALIGN="JUSTIFY">If a MIXN or MIX2 module has been used, the pressure inside the manifold is computed by the algebraic system obtained joining the equations of the three valves (undependently from which of them has actually this quantity as output variable) and the two equations of the mixer (which are not affected by manifold pressure).</P>
<P ALIGN="JUSTIFY">But when a valve is closed, the related algebraic equation is very simple: the flow rate must be null. In this case the values of upstream and downstream pressure are not involved in the equation. When all the three valves are closed, the algebraic system is composed by five equations, none of them affected by the pressure inside the manifold. The system is so singular, and may not be solved.</P>
<P ALIGN="JUSTIFY">If a LEGO model has been build using the mixer in spite of the manifold, the simulation will abort whenever all the three valves will be all closed. The solution is so actually feasibe only if no working condition and manouvering procedure may let all the valves to be closed contemporaneously. The model using COLT module is more complicated and more slow, but it will work in every working condition; the model using MIXN or MIX2 module is more simply and more fast, but it can't work in certain working conditions.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_specdata"></A>Specific data requirement</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">This step looks very easy: for each kind of component the model maker has only to check which data are required by the LEGO module he has choosen and to get them from plant data. Unfortunately this is not always true.</P>
<P ALIGN="JUSTIFY">This problem is obviousely present for not still built plants, when the target of the simulation is an help in plant design. But also for existing plants many data may not be obtaniable, as they may be covered by industrial secret or simply not recorded in any data sheet.</P>
<P ALIGN="JUSTIFY">As an example, steam plant manifolds are designed according to several safety criteria, but the result of the design are only theorical dimensions (diameter, length, thickness, ¼ ). When a manifold is build, the manifacturer has to build it according to the design dimensions and tolerances, but not always one can know the manifold actual dimensions (obviousely nobody can stop the plant only to measure a manifold, and often the thickness is also not very easy to measure when the manifold is mounted into the plant).</P>
<P ALIGN="JUSTIFY">In the following items are described the data which are required for the most common kinds of component. The list is ordered regarding to the plant component and its usage in the plant, and not regarding the related LEGO library module.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_stopvalve"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">stop and safety valves</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_regvalve"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">regulation valves</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_checkvalve"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">check valves</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_pumpfans"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">pumps and fans</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_manifolds"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">manifolds and drums</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_exchangers"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">exchangers and pipelines</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_stepbystep"></A>Step-by-step topology building</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The model topology building phase is the first phase of the true LEGOCAD model construction.</P>
<P ALIGN="JUSTIFY">Theorically the building of the whole model topology could be performed sequentially in one only step. But this is not the best working way. As every phase must be performed according to the requirement of the following phases, the "steady state computation" activity must be analyzed, to check how it affects the topology building.</P>
<P ALIGN="JUSTIFY">The LEGOCAD System needs to compute a steady state working condition. The steady state is computed modifying user "first attempt" values for unknown variables, as the solution of a non-linear algebraic system. If the "first attempt" values are very close to the exact solution, LEGOCAD System will very easily found it; otherwise the solution may be hard to find. If the system order (which is the number of unknown variables) is too high and many variables are far from the steady stade actual values, the solution can't be found.</P>
<P ALIGN="JUSTIFY">So the best way to build a model is starting the model building with only a few blocks (at least only one block) starting with the most "complicated" modules (the modules with more equations to be solved and/or particular modules whose steady state solution requires specific prescriptions). Then the steady state solution may be easily obtained for a model composed by only a few blocks: this will ensure an internal coherence between the values of all the variables contained in these blocks.</P>
<P ALIGN="JUSTIFY">In a second step, the model maker will add another set of blocks, he will assign variables values and he will let LEGOCAD compute the steady state solution again. But now, the steady stade computation will take advantage of the previous step solution, as the variables values previously computed will not change (if the boundary conditions assigned in the previous step were right). The system solution will so require only the computation of a few values (only those of the variables added with the new blocks).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_topology"></A>Model topology building</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">When all the modules (and their numbers of cells, for cellized modules) have been choosen by the model maker, the most important problem in topology building is solved.</P>
<P ALIGN="JUSTIFY">The only check to be performed is to ensure that the choosen modules can be actually connected in the right sequence. When this connection is not directly possible, the model maker has to add auxiliary modules. Auxiliary modules are modules which are not directly related to any process component, but they allow the connection between modules which otherwise couldn't be connected.</P>
<P ALIGN="JUSTIFY">Then the model can be built adding the modules one a time and connecting toghether the variables of the modules.</P>
<P ALIGN="JUSTIFY">When a new process module is selected (if the module has a configurable input/ouput scheme) the LEGOCAD System allow the user to choice the module setup: number of cell, output selection and so on. Each block must be placed in a "macroblock" which is a graphical representation of the model topology, choosing one of the existing icons for the module selected.</P>
<P ALIGN="JUSTIFY">Only in a second time, when the block is placed in a macroblock, the user can select it and recall its variables (one and only one module must be selected to recall variables list). Then he can select another block (which has to be connected to the previously selected module) and recall also the variables list of the secon module. Only when both the windows of the variables list of two blocks are on the screen the model maker can connect variables.</P>
<P ALIGN="JUSTIFY">The connection between an input variable of a block and an output variable of another block (which is the one kind of connection allowed in LEGO models) is performed picking the variable with the mouse and dragging it on the other variable, in the other window.</P>
<P ALIGN="JUSTIFY">Note that an input variable can be connected with only one output variable of another module, while an output variable can be connected with many input variables (belonging to different blocks).</P>
<P ALIGN="JUSTIFY">More than two variables windows can be contemporaneously present on the screen during variables connection phase. There is no theorical limit to the number of variables list present on the screen, but more than four or five windows make the screen very confusing. All the windows must be closed before saving and exiting topology building activity.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_macroblocks"></A>Topological scheme (macroblocks)</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">When a new process module is selected the related block must be placed in a "macroblock" which is a graphical representation of the model topology, choosing one of the defined icons for the module selected.</P>
<P ALIGN="JUSTIFY">More macroblocks may be defined for the same model: they will be considered as different pages of the same drawing (for instance when the model is too large and/or too complicated to be plotted in one page). No graphical connection can be defined between two different pages, but variables of blocks whose icons are placed in different pages can be correctly connected exactly as they were in the same page.</P>
<P ALIGN="JUSTIFY">The graphical representation is not directly connected to the process simulation. A process model whose topological scheme is perfectly drawed, with all the icons in perfect, many connection lines and many explanation comments and the same model without any comment and with all the icons choosen and placed in the worst chaotic manner will be simulated exactly in the same way, obtaining exactly the same results.</P>
<P ALIGN="JUSTIFY">Why should the model maker waste his time in drawing a beautiful scheme?</P>
<P ALIGN="JUSTIFY">First of all it's not a waste of time! It's more easy to select blocks to connect their variables when the blocks are ordered in a logical scheme and the relationships between the blocks are correctly represented and described. During the following building phases (phisical and geometrical data assignment; known and unknown variables selection; boundary conditions and first-guess values assignment) it's more easy to find each block and set its variables and data according to plant data, if the drawing itself explains the block meaning.</P>
<P ALIGN="JUSTIFY">Last but not least, model maker almost never builds model only for its own usage. And the end-user will like to be helped in understanding and using the model. Obviously no help can be given from a chaotic and uncommented drawing, while only a well drawed topological scheme can let the user immediately understand blocks meaning and usage.</P>
<P ALIGN="JUSTIFY">In a macroblock four kind of entities can be present:</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_macicons"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">icons</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_maclines"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">lines</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_maccomm"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">comments</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodpop.htm#lg_model_macsymb"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">symbols</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY">Only the icons <B>must</B> be present for simulation purposes (and there must be exactly one icon for each process block in the model). Lines, comments and symbols are only related to the scheme drawing and they have no effect on simulation, even if they may be more important than icons to understand model functioning and blocks meaning.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT SIZE=5 COLOR="#ffffff"><P>&nbsp;<A NAME="lg_model_blonames"></A></FONT><FONT FACE="Arial, helvetica" SIZE=6>Blocks names and descriptions</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">A block (an instance of a LEGO module) have three different names:</P>
<P ALIGN="JUSTIFY">the block name;</P>
<P ALIGN="JUSTIFY">the block complete name;</P>
<P ALIGN="JUSTIFY">the block internal name.</P>
<P ALIGN="JUSTIFY">The "block name" is four character long (letters, numbers and trailing spaces are allowed), and it is the name assigned by the user when the block is added to the process model. The block name must be unique inside a model; every time a new module is added, the LEGOCAD System checks that the name assigned by the user isn't yet used in the model (otherwise it tells to the model maker to change the name).</P>
<P ALIGN="JUSTIFY">The "complete name" of the block is an 8-character string automathically obtained collating the module name (which is 4-character long) and the block name choosen by the user. The complete name is the name added to the bitmap to obtain the block icon, and it is readable in the topological graphical representation (model macroblocks).</P>
<P ALIGN="JUSTIFY">The "internal name" is an internal representation of the block name, authomatically built by LEGOCAD System, which is not actually interesting for the user. It is often equal to the complete name. Sometimes modules with user-configurable input/output scheme may use this name to record the configuration choosen by the user, modifying one or more of the first four characters (which represent the module name).</P>
<P ALIGN="JUSTIFY">The block name should be used to remember the function performed or the component (or the components) simulated by the block. But as it is only four character lenght and it must be unique, often the acronimous choosen has poor meaning (or it has meaning only for the model maker, if he has a good memory).</P>
<P ALIGN="JUSTIFY">To let the user better understand the function performed or the component simulated every block has also a <B>block description</B> which is a 50-character field which may filled during topology building (also it may be modified furthermore during topology building).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_varnames"></A>Variables names and descriptions</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Every variable has an 8-character name, which is automatically set by LEGOCAD System when the model maker adds to the model the block which the variable belongs.</P>
<P ALIGN="JUSTIFY">The variable name is obtained collating a 4-character abbreviation (unique inside the block, and assigned by the module developer during library construction) and the block name set by the user. The variable name can't be modified by the model maker (only connected input variables change their name, as they keep the name of the output variable which they are connected to).</P>
<P ALIGN="JUSTIFY">Like the blocks, also the variables have their description. variables descriptions are 50-characters long fields, which the LEGOCAD System automathically sets copying tehe default description assigned by the library developer (when the block is added and its variables are created).</P>
<P ALIGN="JUSTIFY">It is <B>very important</B> that the model maker modifies all the variables descriptions to make they explain their meaning in the plant simulation.</P>
<P ALIGN="JUSTIFY">Look at this variable list, obtained adding an instance of the PUMP module:</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=2><P>&nbsp;</P><DIR>

<P>HUPMFWP1 --UA-- FLUID ENTHALPY AT THE PUMP OUTLET</P>
<P>WPOMFWP1 --UA-- FLUID FLOW RATE THROUGH THE PUMP</P>
<P>PUPMFWP1 --IN-- PRESSURE AT THE PUMP OUTLET</P>
<P>PIPMFWP1 --IN-- PRESSURE AT THE PUMP INLET</P>
<P>HIPMFWP1 --IN-- FLUID ENTHALPY AT THE PUMP INLET</P>
<P>OMPMFWP1 --IN-- ROTATIONAL SPEED OF THE PUMP</P>
<P>NPOMFWP1 --IN-- NUMBER OF PUMPS IN PARALLEL</P>
<P>&nbsp;</P></DIR>

</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">What can one understand form this list? Only that this block simulates at least one pump (depending on NPOMFWP1 value) and that these variables belongs to a module whose name is FWP1: not very much, and nothing about the pump function in the plant (assuming one knows the kind of plant simulated).</P>
<P ALIGN="JUSTIFY">Look at this second list, where variables descriptions have been modified:</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=2><P>&nbsp;</P><DIR>

<P>HUPMFWP1 --UA-- WATER ENTHALPY AT 1-ST FEEDWATER PUMP OUTLET</P>
<P>WPOMFWP1 --UA-- WATER FLOW RATE THROUGH 1-ST FEEDWATER PUMP</P>
<P>PUPMFWP1 --IN-- PRESSURE IN FEEDWATER PUMPS OUTLET MANIFOLD</P>
<P>PIPMFWP1 --IN-- PRESSURE AT DEAREATOR OUTLET PIPE BOTTOM</P>
<P>HIPMFWP1 --IN-- LIQUID ENTHALPY INSIDE THE DEAREATOR CAVITY</P>
<P>OMPMFWP1 --IN-- ROTATIONAL SPEED OF THE 1-ST FEEDWATER PUMP</P>
<P>NPOMFWP1 --IN-- NOT USED - MUST BE ONE</P>
<P>&nbsp;</P></DIR>

</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">This is the same list, but now everybody can understand that this block simulates one of the feedwaters pumps of a steam electrical power plant. Now it is very easy to guess that FWP1 means "feedwater pump number 1", even looking only one output variable description!</P>
<P ALIGN="JUSTIFY">Also the last input variable function is more clear in this case: this variable is not actually used in the model, and its value must be always one. If the user has any trouble during a simulation, it's very easy for him to check if the value of this variable is right, undepently from its function inside the PUMP module and the meaning of the FWP1 block inside the model.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_sample1"></A>Example 1: valves and manifold</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The first example of topology building regards the previously considered case of a manifold with two inlet pipes and only one outlet pipe. The example is developer assuming that the fluid present in the system is water (or steam).</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image7.gif" WIDTH=449 HEIGHT=178></P>
<P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_a"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Manifold simulation module</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_b"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Valves simulation module</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_c"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Fluid inlet entalpy</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_d"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Topological connections scheme</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_e"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Topological diagram</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa1.htm#lg_model_sample1_f"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Resulting topological file</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_sample2"></A>Example 2: steam turbine group</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The second example of topology building regards the simulaton of a small steam turbine group. The group is composed of two reaction stages, a turbine induction valve, a bleeding valve (downstream the first reaction stage) and the condenser (downstream the second reaction stage).</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image8.gif" WIDTH=446 HEIGHT=280></P>
<P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa2.htm#lg_model_sample2_a"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">LEGO modules choice</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa2.htm#lg_model_sample2_b"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Variables connection</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa2.htm#lg_model_sample2_c"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Topological connections scheme</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa2.htm#lg_model_sample2_d"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Topological diagram</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa2.htm#lg_model_sample2_e"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Resulting topological file</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_sample3"></A>Example 3: pump and exchanger</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The second example of topology building is a bit more complicated. The plant system simulated is a very small example of an once-through heat recovery steam generator.</P>
<P ALIGN="JUSTIFY">The main target of this example is to show the connections between the water/steam side and the flue gas side in steam generators exchangers. The connections shown and the modelization criteria are always valid, both for boiling, surheated or subcooled water and steam heaters.</P>
<P ALIGN="JUSTIFY">The system is composed of three plant components:</P>
<P ALIGN="JUSTIFY">the water feeding pump;</P>
<P ALIGN="JUSTIFY">the boiling exchanger;</P>
<P ALIGN="JUSTIFY">the steam outlet valve.</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image9.gif" WIDTH=498 HEIGHT=217></P>
<P ALIGN="JUSTIFY">&nbsp;</P>
<P ALIGN="JUSTIFY"><A HREF="file:///D:/usr/users/giugno/doc_lego/models/lgmodsa3.htm#lg_model_sample3_a"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Pump and valve simulation modules</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_b"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Exchanger modelization</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_c"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Scheme of the LEGO model</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_d"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Variables of the EXCH block</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_e"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Connections inside the water/steam line</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_f"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Connections scheme (water/steam line)</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_g"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Connections inside the exchanger</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_h"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Connections scheme (heat exchange)</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_i"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Topological diagram</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsa3.htm#lg_model_sample3_j"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Resulting topological file</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_dat_ass"></A>Phisical and geometrical data assignement</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">After the building of a part of the topology of the plant, the user have to assign the value of the variables and the data envolved in the evaluation of the system equations.</P>
<P ALIGN="JUSTIFY">Modules variables represent (usually) plant quantities and boundary conditions, and their values may change during the simulation, according to the dynamical behaviour of the model.</P>
<P ALIGN="JUSTIFY">On the contrary, phisical and geometrical data represent fixed parameters, whose value could not change due to transient simulation or boundary conditions variations. Examples of typical data are the volume of a cavity, the lenght and the thickness of a pipe or the kind of fluid flowing in an auxiliary system (compressed air, methane, hydrogenon and so on).</P>
<P ALIGN="JUSTIFY">Note that the same quantities may be considered as varying in other kind of simulations: the fluid throwing in a pipe may change if its composition may vary during to plant manouvres. Also the volume of a cavity and the sizes of a tube will change due to plant working conditions if the modet takes into account thermal and mechanical stresses and deformations.</P>
<P ALIGN="JUSTIFY">The kind of data required depends not only on the kind of component, but also on the mathematical model and the LEGO module choosen for the simulation of the component.</P>
<P ALIGN="JUSTIFY">It may appen that the model maker can't get (from plant drawings, components data sheets, technical standards, plant isometrics, design informations and so on) all the data required by the choosen LEGO module. In this case the model-maker must assign a feasible data set, according to plant and simulation targets, to related known data and to his experience on simulation and on LEGO process models.</P>
<P ALIGN="JUSTIFY">Note that some data required by certain LEGO modules are not related to the plant or the component to be simulated, but they regards the kind of phisical and mathematical model used to simulate certain phenomena. As an example, in the EXCH module the user has to choose if the module will take into account the drift phenomenon (the difference of speed between the liquid and gaseous phases of saturated steam inside boiler pipe lines), and the relations to be used to evaluate the thermal exchange coefficent between the fluid and the metal wall. Obviously this kind of data can't be find in plant data, but they must be assigned by the user according to the working conditions and the weight of the component in the behaviour of the plant.</P>
<P ALIGN="JUSTIFY">Unfortunately only a small piece of general advice can be given to the model maker in these two cases. For not-skilled model makers, the best advice is, as usual, to analyse the LEGO model of similar plants, looking at the data used in comparably cases (this is also one of the obliged ways to become skilled model makers).</P>
<P ALIGN="JUSTIFY">The seven </FONT><A HREF="#lg_model_main"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">test cases</U></FONT></A><FONT FACE="Arial, helvetica"> described in this documentation are devoted to this task. Their target is to give to the model-maker an example of the usage of the most important modules present in the LEGO thermodynamical standard libraries.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P ALIGN="JUSTIFY"><A NAME="lg_model_var_ass"></A>Model variables assignement</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The model input variables are all the not connected input of all the blocks of the model, and they represent the boundary conditions of the model. The model output variables are all the state and the algebraic output variables of all the blocks of the models, and they are the output quantities evaluated by the simulation model.</P>
<P ALIGN="JUSTIFY">The target of the model variables assignment is to give to the LEGOCAD System the state of the model at the start of the simulations. Different starting points can be furthermore defined, but no simulation can be performed as long as no initial state is defined.</P>
<P ALIGN="JUSTIFY">The starting state assigned by the user must represent a steady state of the system. To ensure that the starting state assigned by the user is a feasible steady state for the system, the LEGOCAD System has to check (or to evaluate) the steady state starting from the state assigned by the user. As the evaluation of the steady state is performed as the iterative solution of a non-linear algebraic system (see also the related documentation section), the solution can't be found if the starting point assigned by the user is too far from an actual steady state for the system.</P>
<P ALIGN="JUSTIFY">For this reason it's very important to assign values near to an actual steady state for the system. The values of the main variables of the plant should be taken from plant thermal and hydraulical balances, if available. Other values can be taken from the same sources of blocks data: plant drawings, components data sheets, technical standards, plant isometrics, design informations and so on.</P>
<P ALIGN="JUSTIFY">Not available values must be guessed by the model maker, according to related known variables and to his experience on simulation and on LEGO process models. As an example, in a pipe line, sometimes only the pressure levels at the line inlet and the line outlet; the pressures of the fluid all along the line will be guessed by the model maker, according to the valves characteristics, the pipes lenghts and diameters and so on: obviously, if no pump or compressor is present, the pressure in a certain point of the pipe will be lower than the pressure in every previous point (including pipe inlet) and higher than the pressure in every following point (including pipe outlet).</P>
<P ALIGN="JUSTIFY">If the model has to be connected to other model to build a simulator (composed of several process and regulation models), the values of many input variables of each model, which are boundary conditions for that model, are computed by other models as output variables. In this case the model maker must be sure to assign to each of these input variables exactly the same value computed (as output variable) by the other model.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_known"></A>Known and unknown variables</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">A steady state of a system is defined as a state of the plant where the time derivatives of all the plant variables are null.</P>
<P ALIGN="JUSTIFY">During transients simulation, each time steps requires the solution of a non-linear differential-algebraic system. On the contrary, during steady state evaluation, the differential equations become algebraic equations (because the output state variables derivatives values are imposed to zero), so the equations system is completely algebraic.</P>
<P ALIGN="JUSTIFY">During transient simulations, the LEGO Code (the mathematical kernel of the LEGOCAD System) must evaluate the values of all the output variables according to tre values of all the input variables (and according to the previous values and derivatives of state outputs).</P>
<P ALIGN="JUSTIFY">The order of the steady state algebraic system is equal to the number of output variables of the model (including state and algebraic outputs). On the contrary, the number of variables of the system is equal to the total number of variables (including model inputs and outputs). So the system is a rectangular system, with more variables than equations.</P>
<P ALIGN="JUSTIFY">If the system is not singular, it could be solved choosing a feasible set of unknown variables whose number must be exactly equal to the order of the system (which is equal to the number of output variables) and leaving the other variables (whose number will be equal to the number of input variables) as system parameters ("known" variables).</P>
<P ALIGN="JUSTIFY">The easiest solution is to define all the output variables as unknown variables and all the input variables as known variables. But during steady state evaluation no difference is given between input and output variables, as both input and output values affects in the same manner the values of the equations residuals.</P>
<P ALIGN="JUSTIFY">So the user can choose to force the values of an output variable and to make LEGO Code evaluate the value of a (related) input variable. This is the main target of the selection of known and unknown variables. During the steady state evaluation, the variables selected as "known variables" will be kept constant during the iterations, and their final value will be exactly equal to the value assigned by the model maker. On the contary, the values of the "unknown variables" may vary, according to the requirement of the steady state system solution.</P>
<P ALIGN="JUSTIFY">For instance, for the simple equation "a + b + c = 0" there are three possibility:</P>
<P ALIGN="JUSTIFY">1)&#9;a = unknown variable</P><DIR>
<DIR>

<P ALIGN="JUSTIFY">b, c = known variables</P>
<P ALIGN="JUSTIFY">The equation solution is: a = - (b + c)</P>
<P ALIGN="JUSTIFY">b and c values are kept (a value may be changed)</P></DIR>
</DIR>

<P ALIGN="JUSTIFY">2)&#9;b = unknown variable</P><DIR>
<DIR>

<P ALIGN="JUSTIFY">a, c = known variables</P>
<P ALIGN="JUSTIFY">The equation solution is: b = - (a + c)</P>
<P ALIGN="JUSTIFY">a and c values are kept (b value may be changed)</P></DIR>
</DIR>

<P ALIGN="JUSTIFY">3)&#9;c = unknown variable</P><DIR>
<DIR>

<P ALIGN="JUSTIFY">a, b = known variables</P>
<P ALIGN="JUSTIFY">The equation solution is: c = - (a + b)</P>
<P ALIGN="JUSTIFY">a and b values are kept (c value may be changed)</P>
<P ALIGN="JUSTIFY">&nbsp;</P></DIR>
</DIR>

</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_selnoti"></A>Known variables selection</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The solution of the steady state equations system requires that the system itself, once reduced to a square system selecting known and unknown variables, is not singular.</P>
<P ALIGN="JUSTIFY">So the choice of known and unknown variables can't be casual, but it must be done taking into account this condition:</P>
<P ALIGN="JUSTIFY">it must be possible to put each equation of the system into a mutual one-to-one relationship with an unknown variable of the equation, whose variation must actually affect the value of the equation residual.</P>
<P ALIGN="JUSTIFY">Note that "an unknown variable of the equation" may be referred to every variable present in the block, also if it is an output variable of another block of the model (connected to an input variable of the first block).</P>
<P ALIGN="JUSTIFY">This condition is necessary but it may be not sufficient in certain singular working condition of the plant. Nevertheless, as in most working condition it is also sufficient, it is the first condition to check in case of problems during steady state computation.</P>
<P ALIGN="JUSTIFY">The first corollary of this condition is that each equation of the system must contain at least an unknown variable: for this reason the LEGOCAD user can't keep "known" all the variables of an equation.</P>
<P ALIGN="JUSTIFY">Unfortunately this condition is not easy to check, as it actually requires to take into account all the equation contained in all the modules used in the model and the values of a lot of variables. Note that sometimes the influence of a variable on an equations depends not only on the value of the variable itself, but on the value of other quantities involved in the equation.</P>
<P ALIGN="JUSTIFY">As previously said, the easiest solution in known and unknown variables selection is to define all the output variables as unknown and all the input variables as known. But sometimes this is not the best solution (and sometimes it is not feasible).</P>
<P ALIGN="JUSTIFY">As an example, the fluid flow rate through a non-sonic valve is given by a relation which envolves the fluid density, the upstream and downstream pressures and the stem position. Maybe the model maker exactly knows the fluid density, the upstream and downstream pressures and the flow rate and he doesn't know (with the same level of certainty) the stem position; in this case he will select the flow rate between the know variables and he will leave the LEGO Code to evaluate the related stem position.</P>
<P ALIGN="JUSTIFY">Obviously this operating way requires that the imposed flow rate value is a feasible value for the valve (not greater than the maximum discharge capability of the fully opened valve at those inlet and outlet pressure levels). If the valve can't be throwed by the imposed flow rate the computation of steady state of the model will fail.</P>
<P ALIGN="JUSTIFY">For certain particular LEGO modules, it may be better to impose as known an ouput variable rather than all the input variables. For instance, in an lonely manifold the pressure inside the manifold does not directly affect the value of its equation during steady state computation, as the steady state equation for mass conservation is simply a flow rate balances (which does not depend on the value of the pressure inside the manifold).</P>
<P ALIGN="JUSTIFY">In the simulation of a lonely manifold, the pressure must be set as known variable, and one of the inlet or outlet flow rates must be set as unknown (and its value will be changed if the flow rate values assigned by the user did not exactly match the mass flow balance).</P>
<P ALIGN="JUSTIFY">Does the previous sentence means that always the fluid pressure inside manifolds must be set as known variable during steady state computation?</P>
<P ALIGN="JUSTIFY">No, it only means that it must be done only when no other equation (in other blocks of the plant) is actually affected by its value.</P>
<P ALIGN="JUSTIFY">For instance, if there is a valve downstream the manifold, we can let the manifold evaluate the flow rate through the valve (from steady state mass balance in the manifold) and the valve will evaluate the pressure inside the manifold (which affects the internal equation of the valve). This can be done also for an upstream not-sonic valve, but not for an upstram sonic valve, as in this case the value of the pressure in the manifold doesn't affect the internal equation of the valve.</P>
<P ALIGN="JUSTIFY">In this case, the flow rate through the valve can be put into one-to-one relationship with the equation of the mass balance in the manifold and the pressure inside the manifold can be put into one-to-one relationship with the constitutive equation of the valve.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_steady"></A>Steady state computation</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The following step in the building of a LEGO model is to obtain a steady state condition for the system model itself. As previously said, the model is in a steady state when all the variables characterizing the various system processes do not change in the time if the boundary conditions of the system are not perturbed.</P>
<P ALIGN="JUSTIFY">The LEGO equation solver calculates a steady state with an iterative procedure: during this procedure the differential equations become algebraic equations (the output state variables derivatives values are imposed to zero), so the equations system is completely algebraic.</P>
<P ALIGN="JUSTIFY">The "known" variables will be considered as parameters during steady state evaluation, and their value will not be changed. On the contrary, the values of "unknown" variables will not vary only if the computation starting point defined by the model maker is just a steady state condition for the system (it means: only if the values of all the unknown variables are the right values in function of the values assigned to known variables). Otherwise their value will be changed during steady state computation according to the values imposed for the known variables.</P>
<P ALIGN="JUSTIFY">The solution of the steady state system is the solution of a multi-variables non-linear algebraic system. The solution of the system is performed with an iterative procedure using the Jacobian matrix of the system. Like every multi-variable non-linear system, the solution can be found only if the starting point assigned by the user is close enought to the "right" solution (the steady state of the system).</P>
<P ALIGN="JUSTIFY">So the assignment of the values to the "unknown" model variables can't be casual: the LEGOCAD user must not think that the LEGO solver will be able to find the equations solutions starting from any initial value of the model variables, but he must take into account the physical interactions between the model variables.</P>
<P ALIGN="JUSTIFY">The LEGOCAD System provides to solve the equations system by the "Steady State" program and to calculate, with a precision assigned by the LEGOCAD user, the values of the unknown variables. The precision assigned by the user is the maximum absolute value admitted for equations residuals in the steady state computed. The iterative solving process will continue until all the residuals of all the model equations are less (in absolute value) than the precision limit assigned by the user (or until the maximum number of iterations is reached, or any mathematical problem will occurr).</P>
<P ALIGN="JUSTIFY">The "Steady State" program provides also to inform the user about the mathematical details during the iterative process of calculation: at every iteration the user can examine the residual values for all the equations, the Jacobian matrix and possible numerical problems. These informations are particularly useful if the "Steady State" program can't find the solution of the equations system: the LEGOCAD user, examining the informations, can change the values of the model variables or the choice of the "known" variables, to obtain better results.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_failure"></A>Steady state computation failures</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Four kind of problem may cause steady state computation failure:</P>
<P ALIGN="JUSTIFY">the starting point assigned by the user was too far from an actual steady state and the iterative could not get the right solution;</P>
<P ALIGN="JUSTIFY">some error has been made during the assignment of data or variables, whose value may cause numerical problems or they &#9;may define a different working condition (feasible but too far from the starting point assigned by the user) or a non-feasible &#9;working condition;</P>
<P ALIGN="JUSTIFY">the selection of known and unknown data makes one or more equation of the model impossible to be satisfied;</P>
<P ALIGN="JUSTIFY">particular values of certain model variables (assigned by the user or computed during computation iterations by the &#9;LEGOCAD System) makes one or more equation of the model impossible to be satisfied.</P>
<P ALIGN="JUSTIFY">The last problem may occur when any "bounded" data (like stem positions, whose value must be in the range 0 ÷ 1) are set as "unknown" variables, and the LEGO solver could not satisfy the working conditions imposed by the user.</P>
<P ALIGN="JUSTIFY">The last problem may also occurr when particular values of certain variables modify the form of an equation, whose residual value become undependent from any variable of the system (or, on the contrary, an unknown variable doesn't affect the value of any equation).</P>
<P ALIGN="JUSTIFY">As an example, in a check valve, if the downstream pressure is greater than the upstream pressure, the flow rate is checked, and the upstream pressure value does not affect the residual of the valve constitutive equation. If the upstream pressure is an unknown variable and its value doesn't affect any other model equation, the system can't be solved as the actual value of the pressure is undefined. In this case the right solution is to set the right value to the upstream pressure, and to let as unknown variable the flow rate (whose value will be set to zero by LEGO code).</P>
<P ALIGN="JUSTIFY">This example is very interesting because one can see that the four kind of problem previously listed are not so cleanly divided: the solution of a problem about particular values of certain variables has been solved modifying not only the value of the variable, but also the selection of known and unknown variables.</P>
<P ALIGN="JUSTIFY">The problem of a too far starting point may be solved with a better knowledge of the process simulated by the model. If the values of many variables have been guessed by the model maker, a better attention in values variables assignment may be sufficient to solve the problem. This kind of problem is more easy to occurr with big models, when the values a lot of variables are not exactly known by the model maker; in this case the best solution is to build a smaller model, with only a part of the blocks of the model (at least only one or two blocks, if they are very complicated).</P>
<P ALIGN="JUSTIFY">LEGO solver can more easily find the steady state for a small set of blocks. If the model maker after the needed check, accepts the values computed by LEGO solver for unknown variables, he can be sure that (for this set of blocks) the known and the unknown variables actually represent a steady state for the model. When the rest of the blocks (or a part of the rest, according to the philosophy of a step-by-step model building) are added, the model maker can more easily find (and correct) the block (or the blocks) which causes steady state computation failure (as at each step, the problem may only be caused by the blocks added in that step).</P>
<P ALIGN="JUSTIFY">A similar working way is to build several small models, each of them composed of a small set of blocks, and to make LEGO solver evaluate the steady state for each of them. The model maker can so more easily check where, when, which and why problems occur in that small models. The building of the complete model joining these small models will be very easy, also if at the moment no authomatical procedure can be used to join two or more models into one bigger model (this operation can be done manually modifying the internal LEGOCAD files containing the description of the model, but this operation may easily cause serious and unrecoverable damages, so it may be done only by very skilled model makers and it is intentionally not described in this documentation).</P>
<P ALIGN="JUSTIFY">Before these models can be joining, the model maker must check that there is an exact match between the values of the input variables which will be connected to output variables of other models and the values of the related output variables. This check may also reveal unpredictable differences between these values, which are the clean symptoms of some problem in model building.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_success"></A>Steady state computation success</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The success of the steady state computation activity only means that the LEGO solver could find a solution of the steady state system starting from the working conditions assigned by the user.</P>
<P ALIGN="JUSTIFY">This doesn't automatically means that the computed steady state represent the right steady state for the model. The model maker should ckech that the values computed by the LEGO solver for the unknown variables are close enough to the expected values.</P>
<P ALIGN="JUSTIFY">If one or more values are too far from the expected values, two possible problems are present:</P>
<P ALIGN="JUSTIFY">some error has been made during the assignment of data or variables, whose value define a different working condition &#9; &#9; (feasible, but too far from the steady state condition expected by the user);</P>
<P ALIGN="JUSTIFY">the steady state condition expected by the user is wrong, and the resulting evaluated state is right in function of the values imposed for the known variables.</P>
<P ALIGN="JUSTIFY">The second kind of problem may also occurr when the model maker takes its data from an external data source (plant design, heat balance and so on), but this means that the data source contains one or more error. A serious model maker can suppose that this hypotesis is true only he is <B>actually sure</B> that <B>every other possible</B> explanation has been excluded and no error has been made in variables and data values assignment.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_testran"></A>Test transient simulation</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The main target of a system model is to study its time evolution when its boundary conditions are perturbed, so the steady state of the model represents the starting point for a simulation. A test transient is also a way to check that the model built is correctly working.</P>
<P ALIGN="JUSTIFY">A test transient is a simulation case whose results (main variables values and trends) may be easily foreseen by the model maker. The simulation of a test transient does not differ in any item from the simulation of a </FONT><A HREF="#lg_model_transient"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">plant transient</U></FONT></A><FONT FACE="Arial, helvetica">, but it may be performed also on incomplete or partial models, to ckeck that the model building process is rightly going on.</P>
<P ALIGN="JUSTIFY">When the model building phase is finished, the model maker must simulate the most important set of plant manouvres (according to the targets of the built model) to check that the simulation results are correct (in comparision with the expected values and trends).</P>
<P ALIGN="JUSTIFY">In this case, the model maker should also check the number of iterations needed to the LEGO Code at each time step of the transient. Note that several kind of numerical problem are also reported on the output file of the transient (LG5.OUT).</P>
<P ALIGN="JUSTIFY">Theoretically no numerical problem should occurr during the simulation of small range working condition variation. On the contrary, the occurence of certain kind of light numerical problems during the simulation of large range working condition variation is not automathically a symptom of model maker errors, as they may be caused by particular solutions used in library modules. Obviously the abortion of the simulation can't be cosidered a "light numerical problem" if the plant manouvre has been simulated in the right way (but nobody can ask a model to rightly simulate a wrongly simulated manouvre).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_example"></A>Example of a LEGO model building</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The following example shows the building of a very simple hydraulical model constituted by a water pump with a valve at its discharge. The flow diagram of the system is the following:</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image10.gif" WIDTH=320 HEIGHT=84></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The main components of this system are the water pump and the water valve, but we want to represent also the tubation that connects the pump discharge with the valve inlet: if its volume is relevant, the mass and energy storage phenomena in the tube (for the water and the metal wall) can't be neglected. Besides, the tube causes a water head loss that may be computed in the water head loss through the valve (it is usual for pipes and tubes to take into account head loss and storage phenomena in different modules).</P>
<P ALIGN="JUSTIFY"><A NAME="a"></A></P>
</FONT><P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_a"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Modules selection</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_b"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">List of blocks variables</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_c"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Blocks connections</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_d"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Data collection</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_e"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Blocks data assignment</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_f"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Variables assignment</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_g"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Steady state results</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_h"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Execution of a test transient</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="lgmodsam.htm#lg_model_example_i"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">Test transient results</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_model_transient"></A>Transients simulation</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The main target of a system model is to study its time evolution when its boundary conditions are perturbed, so the steady state of the model represents the starting point for a simulation.</P>
<P ALIGN="JUSTIFY">The boundary conditions of a LEGO model are represented by all the free input variables of the model itself.</P>
<P ALIGN="JUSTIFY">The "Transient Calculation" program of the LEGOCAD System allows the user to define the simulation parameters and the input variables perturbations, while with the "Graphics" utility it is possible to examine the time trend of the model variables. The model variables values are recorded, in the course of the simulation, in a <I>file</I> called "f22".</P>
<P ALIGN="JUSTIFY">The simulation parameters that have to be defined by the LEGOCAD user are the following:</P>
<P ALIGN="JUSTIFY">1)&#9;Integration step: the choice of the integration step value is very important to study the dynamical behaviour of the system model. If the &#9;dynamical phenomena represented by the system model are "fast", the integration step value must be low; otherwise it's convenient &#9;to use a higher integration step value to reduce the calculation time. For steam-water circuits of thermo-hydraulical plants it is usual to &#9;define an integration step value of about 1 second (or a little higher); instead, for air-gas circuits the integration step value has to be &#9;lower because the dynamical phenomena are "faster" (obviously the LEGOCAD user must take into account the geometrical and the &#9;physical characteristics of the system, because they strongly influence the magnitude of the system processes time constants).</P>
<P ALIGN="JUSTIFY">2)&#9;Recording step: the variables values are calculated at every time step, but the user can decide to record them in the <I>file </I>"f22" every <I>n</I> &#9;time steps to limit the dimension of the storage area required by a certain simulation period.</P>
<P ALIGN="JUSTIFY">3)&#9;Variables recorded: the user has to specify which variables he wants to record during simulation.</P>
<P ALIGN="JUSTIFY">4)&#9;Time scaling: the user can choose the simulation speed compatibly with the computer calculation speed.</P>
<P ALIGN="JUSTIFY">5)&#9;Max simulation time: the user can decide a maximum time for the simulation duration.</P>
<P ALIGN="JUSTIFY">The perturbations that the user can give to the model input variables are of different type: step, ramp, pulse, sinusoidal, trapezoidal, noise.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=5 COLOR="#ffffff"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_simul_main"></A>LEGO simulators</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">If a LEGO model contains several hundreds of LEGO modules, and these modules contain several equations, the model equations system become too complex, and the LEGO solver has strong difficulties to find the system solution in a reasonable time. For this reason, when the system is too complex to be represented by only one LEGO model, it is necessary to divide it in several subsystems, so that each of them can be simulated by only one LEGO model. The whole system model is called "LEGO simulator", while the subsystems models are called "LEGO tasks". The first important division consists on the separation of the process from the regulation: a simulator will be constituted by "process tasks" and "regulation tasks". Further subdivisions of the system are oriented to obtain systems having a sufficient reduced complexity; to get this target it is convenient to follow some generic rules:</P>
<P ALIGN="JUSTIFY">1)&#9;the single tasks should possibly have the same size;</P>
<P ALIGN="JUSTIFY">2)&#9;the blocks defined in a task have possibly to represent components physically connected and having a similar dynamical behaviour;</P>
<P ALIGN="JUSTIFY">3)&#9;the interactions between the tasks must be limited (the tasks have to be little dependent).</P>
<P ALIGN="JUSTIFY">For instance, by the application of the previous rules, it is convenient to divide the model of a conventional steam power plant (process part) into the following tasks:</P>
<P ALIGN="JUSTIFY">1)&#9;Water-steam circuit of the steam generator</P>
<P ALIGN="JUSTIFY">2)&#9;Air-gas circuit of the steam generator</P>
<P ALIGN="JUSTIFY">3)&#9;Steam turbine</P>
<P ALIGN="JUSTIFY">4)&#9;Condenser, extraction pumps and low pressure preheaters</P>
<P ALIGN="JUSTIFY">5)&#9;Deareator, feedwater pumps and high pressure preheaters</P>
<P ALIGN="JUSTIFY">As LEGO modules can be connected together with the purpose of building the topology of a LEGO model, in the same way LEGO tasks can be linked each other for the construction of a simulator: the procedure of connecting LEGO tasks in a simulator is similar to the procedure of connecting modules in a LEGO model.</P>
<P ALIGN="JUSTIFY">The single process task of a simulator is a LEGO model in every respect: the only difference is that, while the model is devoted to be used alone, the task is devoted to be interfaced with other ones.</P>
<P ALIGN="JUSTIFY">While for a single model the LEGO mathematical solver "sees" only one equations system, for a simulator the LEGO Code has to solve a number of equations systems equal to the tasks number: each task is independent from the other ones, so the user can choose different integration steps values for the different tasks.</P>
<P ALIGN="JUSTIFY">The first step for the simulation of a system behaviour is to calculate a steady state for all the tasks of the simulator in respect of the system continuity: if a variable is at the same time input of a task and output of another task, it should have possibly the same value (or similar values) for the two tasks steady conditions. This is not a rule, but it is necessary to have a good starting point for the simulation.</P>
<P ALIGN="JUSTIFY">The "LEGO scheduler" is the program that manages the simulation of the single tasks in parallel: the main target of this program is to insure the passage, from task to task, of the connected variables and to regulate the single task simulation speed. Initially the user runs the scheduler program to obtain a steady condition for the simulator: if the system boundary conditions are not perturbed, after a transient period, all the system variables should reach a steady value (well, this is true only for stable or well regulated systems). To get better this target the user has to set the control parameters in regulation tasks to appropriate values to guarantee the system stability.</P>
<P ALIGN="JUSTIFY">If the system variables don't reach a steady value, but their trend is divergent, the user can try to change the control parameters values or to calculate better starting steady conditions for the simulator tasks and then restart the simulation.</P>
<P ALIGN="JUSTIFY">When a steady condition is reached the user can save it as a "snapshot": in this way, when he wants to restart the simulation, he can start from this initial steady condition, loading the "snapshot"</P>
<P ALIGN="JUSTIFY">As in a single LEGO model the free input variables can be perturbed during a simulation, in the same way the user can change the boundary conditions of the simulator and examine the time trend of all system variables consequently to these perturbations. The user has also the possibility, in every moment, to save a system condition as a "snapshot", and to restart the simulation from this point.&nbsp;</P></FONT></BODY>
</HTML>
