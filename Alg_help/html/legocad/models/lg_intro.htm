<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>LEGOCAD</TITLE>
<META NAME="Template" CONTENT="C:\Microsoft Office\Office\html.dot">
</HEAD>
<BODY>

<B><FONT FACE="Arial, helvetica" SIZE=6><P ALIGN="JUSTIFY"><A NAME="lg_intro_main"></A>Introduction to LEGOCAD System</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="JUSTIFY"><A HREF="#lg_intro_lego_code"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">The LEGO Code</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_intro_libra"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">The libraries of the LEGO Code</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_intro_regu"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">The regulation in the LEGO Code</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_intro_interf"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">The LEGOCAD user interface</U></FONT></A></P>
<P ALIGN="JUSTIFY"><A HREF="#lg_intro_numb"><U><FONT FACE="Arial, helvetica" COLOR="#0000ff">The LEGOCAD solver</U></FONT></A></P>
<FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_intro_lego_code"></A>Introduction to the LEGO Code</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGO Code is the mathematical "core" of the LEGOCAD System. Its purpose is to realize the mathematical model of a system beginning from the mathematical models related to single components, and the following resolution of differential and algebraical equations representative of the realized model.</P>
<P ALIGN="JUSTIFY">In fact, the LEGO Code modularity allows to realize separately the models concerning different components and only in a second time it allows to define the interactions among single components to obtain the plant model.</P>
<P ALIGN="JUSTIFY">The algebraical-differential system, representative of plant model, is obtained connecting the different equations which are descriptive of single components.</P>
<P ALIGN="JUSTIFY">Simulations are carried out solving such algebraical-differential system in a numerical and iterative way by the dumped Newton-Raphson's method.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Definition of "LEGO module" (component model)</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The model of a single component is called "LEGO module". Typical examples of such modules are those modelling pumps, valves, pipings, tanks, heat exchangers, turbine stages and so on.</P>
<P ALIGN="JUSTIFY">Particular cases of LEGO modules are those modelling regulation and automation system of plants. Such modules are called "regulation schemes": the LEGO modules in the true sense of the word are those intended for process components.</P>
<P ALIGN="JUSTIFY">The LEGO module must contain the equation linking each other the characteristic variables of the considered component. Such equations can be both algebraical or differential also having any complexity.</P>
<P ALIGN="JUSTIFY">Besides the equations constituting single components, the LEGO modules has also to provide their Jacobian matrix (matrix of the partial derivatives related to single equations with respect to all module variables). An appropriate routine, carrying out in a numerical way the calculation of such matrix, can be utilized if the equations has considerable complexity (very frequent case).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Definition of "LEGO model" (system model)</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGO modules which represent components constituting a system, are linked on the basis of the logic scheme of the system itself.</P>
<P ALIGN="JUSTIFY">In case of thermodynamic systems, the scheme corresponds, actually, to the system fluogram. In fact, to every component correspond one or more LEGO modules which have to be linked keeping the fluogram logic sequence. This connection is carried out by using the LEGOCAD user interface, and aims at imposing the logical constraints corresponding to the physical ones deriving from the plant typology.</P>
<P ALIGN="JUSTIFY">For example, if a pump is connected with two pipings, upstream and downstream it, the outlet flow rate coming from the first piping must be equal to that entering the pump, in the same way the flow rate coming from the pump must be equal to that entering the second piping. Besides, not considering the accumulation mass in the pump, the inlet and outlet flow rates will be equals each other and equals to those flowing out of the first piping and entering the second one.</P>
<P ALIGN="JUSTIFY">In many case, for example, when connections and branches are present, it needs to put into the module also auxiliary modules to obtain the desired connections.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>The LEGO model for a plant</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">It is not possible to carry out models including several hundred of LEGO modules, because of size and complexity reasons that system to solve would take up (the maximum number is 300, but it exists also a maximum number of variables which often is more constraining).</P>
<P ALIGN="JUSTIFY">When the plant is too complex for simulate it through only one LEGO model, it needs to subdivide it in several systems so that each of them can be simulated by only one LEGO model. The first division consists in separating process from regulation, proceeding then to further subdivisions up to obtain systems having a sufficient reduced complexity.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Definition of "LEGO task" and "simulator"</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The single models in which the simulator concerning a complex plant is subdivided are called "LEGO tasks".</P>
<P ALIGN="JUSTIFY">As the LEGO modules are linked each other in carrying out LEGO models, the different tasks have to be connected to impose the continuity of a plant model. These connections are the same which would have been carried out among LEGO modules if these modules would have been inserted into the same model.</P>
<P ALIGN="JUSTIFY">For example, if a task simulates the boiler of a conventional electric station, and another one simulates the turbines unit, steam conditions at the turbine inlet valve must be imposed as equals to those related to the last boiler outlet header; in the same way the steam flow rate extracted from such header must correspond to that flowing through the same valve.</P>
<P ALIGN="JUSTIFY">The difference (purely formal) between a LEGO model and a task is so defined. A task is a model in every respect, and like this can be dealt with; nevertheless a model is devoted to be used alone, to simulate the behaviour which represents, whereas a task is devoted to be interfaced with other ones to simulate a set having wider proportions.</P>
<P ALIGN="JUSTIFY">On the other hand, a task can also be used alone if the boundary conditions, represented by other model tasks, are imposed. For example, in the already mentioned case of conventional thermoelectric station, the turbine task can be also used without the boiler task, provided that the laws concerning the variations in time of the inlet steam conditions are known (which, for sufficiently high powers, can be considered constants and equals to those under functioning nominal conditions).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>The "scheduler" program</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The scheduler is the program which allows to simulate single tasks in parallel, and to maintain their connection. To keep the actual parallelism among the tasks, assuring the passage of the connected variables and regulating the single task simulation speed, is a particularly important goal of the scheduler.</P>
<P ALIGN="JUSTIFY">In fact, the simulation speed managed by the scheduler, does not depend directly on processor speed on which the simulator works (to which corresponds the upper limit of execution speed), but is linked to the real-time.</P>
<P ALIGN="JUSTIFY">User, in fact, may assign a parameter defining the ratio between real and simulated time: if such parameter is 1, the actual time of processing will be equal to the simulation duration. This happens independently from complexity of the realized simulator, provided that such complexity does not exceed the computer processing capacity.</P>
<P ALIGN="JUSTIFY">If the model is too complex or the processor too slow, user can require that simulation carries out more slowly than real-time (for example at half real-time). On the contrary, if the considered model is simple, a simulation carrying out faster than real-time can be required (even several times faster, if the model is very simple).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>The tasks non-LEGO and the interface with the field</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The scheduler, which manages single tasks and assures their informations exchange is able to see, in the reality, more process to read and write data from the same shared memory area. Consequently through the scheduler it is possible to interface the LEGO modules with others carried out by using different simulators, with regulation and automation systems and directly with the plant; in this case they must be able to exchange data with the mentioned memory area (directly or through appropriate software and/or hardware interfaces).</P>
<P ALIGN="JUSTIFY">This allows, for example, to test control panel interfacing them with a model rather than the plant (process LEGO and external regulation) or, on the contrary, to employ the LEGO as advanced system for plants regulation (physical plant and LEGO regulation). It further allows the plants monitoring, simulating measures not directly exctractable from the plant itself, obtaining them from available measures (supervision advanced functions).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_intro_libra"></A>Introduction to the libraries of the LEGO Code</P>
</FONT><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Standard module libraries of the LEGO Code</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The availability of already realized and tested modules for simulating main components is very helpful in carrying out a plant model.</P>
<P ALIGN="JUSTIFY">The standard libraries of the LEGO modules serve to LEGOCAD System users in carrying out their simulators by using only ready modules whose correct functioning is assured avoiding in such way to realize new ones.</P>
<P ALIGN="JUSTIFY">A further advantage, of primary importance, is that different plants, carried out by different operators, result much more homogeneous and integrable as regards to the case in which for each model would use non-standard modules realized "ad-hoc".</P>
<P ALIGN="JUSTIFY">At the moment, the LEGOCAD System has three libraries integrating each other which allow the simulation of nearly the totality of thermoelectric plants nowadays in use: the thermodynamic library for real-time simulations, the thermodynamic library for reference models and the library for thermonuclear plants.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Thermodynamic library for simulations in real-time</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">This library is utilized in most of cases for simulations in real-time and allows the modelling of all components concerning combined-cycle, gas and steam thermoelectric stations: combustion furnaces (for steam and gas turbine boilers), water/water water/flue gas and air/flue gas heat exchangers (heaters, economizers, boiling channels, Ljungstr&ouml;m heaters, etc.), condensers, degazifiers, turbines (steam and gas), steam drums, headers, pumps, valves (hand and motor operated valves, regulating valves, both in sonic and non-sonic field), pipings, metallic walls, compressors for gas-turbine and so on.</P>
<P ALIGN="JUSTIFY">In addition, typically mechanic and electric modules are included. They are directly involved in electric station models (electric motors, internal combustion engines, inertia of rotating masses, alternators, electric distribution networks for finite and infinite powers, etc.) as well as a large number of auxiliary modules like adders, multipliers, linear relations and so on.</P>
<P ALIGN="JUSTIFY">Finally, are also included specific modules for simulation of main auxiliary systems present at conventional thermoelectric and combined-cycle stations (evaporating towers, treatment of gas-turbine feeding gas, compressed air treatment, coal breakers, etc.) as well as for control and supervision of advanced functions (mechanic and thermal stresses monitoring in turbine rotors and boiler headers).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Other libraries of the LEGO Code</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The library for simulations in real-time has been realized in order to obtain electric plant models which (on appropriate processors) could be simulate in real-time.</P>
<P ALIGN="JUSTIFY">Therefore such libraries are not steered to the analysis of phenomena having a very short duration time which exhaust themselves within few seconds (or even less than one second), and which have to be analysed with very reduced time intervals. Besides the models for simulation in real-time are sometimes simplified and do not take into account phenomena which, in most of cases, can be considered as marginal.</P>
<P ALIGN="JUSTIFY">Nevertheless, the LEGO Code is absolutely able to carry out even the simulation of particular phenomena and very fast dynamics: on this subject the thermodynamic library for reference models is available. Their modules simulate the behaviour of components already present in the standard library for real-time, but models are realized with greater detail even taking into account phenomena which often are not considered.</P>
<P ALIGN="JUSTIFY">The thermonuclear library, completed with modules for liquid sodium treatment (for stations type PHOENIX) is used in a massive way by EDF (French National Electric Company) in simulating their own nuclear power plants.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>User library</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">In some cases the library modules are not adequate or suitable in modelling a system to simulate; this surely happens if this system is not thermodynamic.</P>
<P ALIGN="JUSTIFY">In these cases, user can set up further LEGO modules "personalized" realizing the functions not included in the library. A computer-based procedure produce the FORTRAN source which user has to complete with the equations representative of the component or system to simulate.</P>
<P ALIGN="JUSTIFY">In such way, the LEGO Code can be used for the simulation of robots, mechanical plants and electric systems, in modelling of advanced thermoelectric plants (like fluidized beds and fuel cells) or plants having unusual sizes (therefore not always fitted to be simulated by standard modules) and even in simulations of one or more component models needing of considerable simplifications (when it is useful to simulate their internal behaviour).</P>
<P ALIGN="JUSTIFY">A more complete description of how to realize an user module is given in the special section of this documentation.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Distinction between moduling and modelling</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">As already mentioned, the modularity of the LEGO Code allows to divide the tracing of mathematical models concerning single components (modules LEGO) from the assembling of same components to carry out models and simulators.</P>
<P ALIGN="JUSTIFY">Besides, this allows to separate the dynamic simulation activity into two different branches: moduling and modelling.</P>
<P ALIGN="JUSTIFY">Moduling is the more theoretical branch which belongs to the experts of the behaviour (physical, chemical, mechanical, electric, thermodynamic etc.) and regards both single components and processes occurring inside them.</P>
<P ALIGN="JUSTIFY">It is useful to note that moduling expert has to possess specific competencies about the branch interested by the component; on the contrary a particular plant engineering knowledge is not requested, with the exception of interface problems related to the module during the realization phase.</P>
<P ALIGN="JUSTIFY">On the other hand, modelling is the more applicatory branch. Modelling expert must be able to understand the plant structure identifying possible simplifications which, in any case, allow a correct system simulation. Finally, he knows the characteristics of all available modules and, from time to time, he chooses the more suitable one to simulate each component.</P>
<P ALIGN="JUSTIFY">Therefore, on the basis of such considerations, modelling expert must have a good experience both in plant engineering and in LEGO Code use.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_intro_regu"></A>Introduction to the regulation in the LEGO Code</P>
</FONT><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Regulation scheme definition</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Particular cases of LEGO modules are the "regulation schemes". They are intended for control, regulation and automation functions of plants simulated by the LEGO Code.</P>
<P ALIGN="JUSTIFY">Regulation schemes constitute appropriate control systems which are able to deal with (inside them) both continuous (in digital) and logic informations.</P>
<P ALIGN="JUSTIFY">The definition of the regulation schemes is performed beginning from elementary modules, typical of a digital or analogue control, including basic logic components.</P>
<P ALIGN="JUSTIFY">Considering that each plant has own particular control systems, whose generalization is not applicable, a control schemes library is not foreseen.</P>
<P ALIGN="JUSTIFY">However it is possible to copy a scheme realized for a different plant or another subsystem of the same plant if it is similar or even identical.</P>
<P ALIGN="JUSTIFY">This is feasible, for example, when the considered plant consists of several parallel lines operating in a similar way and controlled through the same regulation strategies.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Regulation modules library</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Whether a library of ready regulation schemes is not foreseen, because devoid of usefulness, a regulation modules library consisting of basic blocks is available: these blocks are used to built a regulation scheme.</P>
<P ALIGN="JUSTIFY">Such blocks are, for example, algebraical adders (with two or more input), multipliers, divisors, integrators, derivatives, filters, PI controllers (proportional-integral), non-linearity (gates, saturations, etc.) and generators of functions in one variable (useful to simulate more complexes control algorithms).</P>
<P ALIGN="JUSTIFY">Besides, are included main logic components (operators AND, OR, NOT, XOR), of logic/regulation interface (switcher and relational operators) and of interface with the operator (control push-buttons and potentiometers).</P>
<P ALIGN="JUSTIFY">Finally are included input/output blocks (regulation/plant interfaces), branching and signal separators; the last are needing to break algebraical loops not admitted inside the regulation schemes (since the schemes are solved "in cascade").</P>
<P ALIGN="JUSTIFY">Unlike process modules, the possibility that user can carry out some personalized regulation modules is not foreseen.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Building of a regulation scheme</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">Building of a regulation scheme is similar to those concerning a LEGO model: in fact, it consists in selecting and linking different regulation modules up to obtain the requested scheme.</P>
<P ALIGN="JUSTIFY">Nevertheless, as regards to a LEGO model, building of a regulation scheme is much easier since the blocks to link are elementary (so is also elementary their way of mutual connection). Besides, unlike process models, user can realize the scheme and the connections directly through graphic path using the REGOGRAF utility. A more complete description is given in the proper section of this documentation.</P>
<P ALIGN="JUSTIFY">This utility allows the definition of a regulation scheme, its transformation in a FORTRAN source, the assignment of parameters and variables peculiar to regulation as well as the simulation of the scheme behaviour disconnected from the plant.</P>
<P ALIGN="JUSTIFY">So we can state that, once a regulation scheme is theoretically designed, its transformation into a LEGO scheme, and its following use inside the model plant, are problems whose difficulty can be easily overcome (provided that operational environment inside REGOGRAF data base was already set up).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Implicit and explicit regulators</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGO regulation schemes do not participate to the iterative solution of the algebraical-differential system representing the plant to simulate.</P>
<P ALIGN="JUSTIFY">In fact, they do not include iterative equations (solved by LEGO solver), but only equations made explicit and solved directly inside the single regulation blocks which made up them. Besides, the LEGO regulation schemes are called back, for each time interval, only at the beginning of system solution iterative cycle.</P>
<P ALIGN="JUSTIFY">Unfortunately this cause a delay of one time interval to the feedback operated by the schemes, since it is based on the system internal variables value valid at the preceding time interval.</P>
<P ALIGN="JUSTIFY">As a rule this restriction is irrelevant, but since the regulation output values can be incorrect, it can origin some problems in determining of actual stationary condition in the model.</P>
<P ALIGN="JUSTIFY">This occurs, for example, when proportional regulators or proportional- derivatives (without integral components) are utilized. For these, in fact, the output directly depends on input value (error), which must never be null (only as particular case).</P>
<P ALIGN="JUSTIFY">Such problems can be solved realizing the regulator as a LEGO module (and not as a regulation scheme), encoding inside the requested regulation laws.</P>
<P ALIGN="JUSTIFY">In this case, the regulator is a real personalized LEGO module residing in the user library and it has to be carried out following the normal procedure related to the process modules.</P>
<P ALIGN="JUSTIFY">The LEGO modules which operate regulation actions are called "explicit regulators": some of them, more commonly used, are already included in the standard thermodynamic library. On the contrary, the conventional regulators (regulation schemes) are called "implicit regulators".</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_intro_interf"></A>Introduction to the LEGOCAD user interface</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGOCAD interface guides the user in carrying out the three basic activities of LEGO Code: model topology definition, calculation of a plant stationary condition and plant transient calculation.</P>
<P ALIGN="JUSTIFY">The LEGO Code carries out the simulations beginning from a model which has to be encoded in two files ASCII having a well defined structure peculiar of the LEGO code itself. The first one, named F01.DAT, includes the model topology description whereas the second one, named F14.DAT, includes the initial values of model variables and the physical/geometrical data of single blocks (needs of LEGO modules).</P>
<P ALIGN="JUSTIFY">Unfortunately, the structure of these two files is very strict and would be decidedly inopportune to compel user to write them. In fact, he would be compelled to concentrate part of his efforts in respect the structure of such files, taking his attention off the actual problem (the realization of the simulator) requesting him a too high specialization in LEGO Code use.</P>
<P ALIGN="JUSTIFY">The LEGOCAD user interface allows to define in a simple way the modules to utilize and their links, drawing up therefore the file F01.DAT. in an automatic manner. Besides it allows to insert, in a correct way, data and variables values into the file F14.DAT. (which is performed in an automatic manner by the LEGO Code).</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Generation of the operational environment</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">To utilize the LEGOCAD System, the outline of each user (control procedure automatically activated in the login phase) has to recall an appropriate LEGOCAD procedure which, substantially, informs the operational system about the location of different LEGOCAD System elements.</P>
<P ALIGN="JUSTIFY">At this point the LEGOCAD, activated by user for the first time, generates his own operational environment for that user. Every time user creates, modifies or erases a model, LEGOCAD interface carries out the needing modifications to such operational environment (creation or erasing of directory, generation, modification and/or erasing of files etc.).</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=6><P><A NAME="lg_intro_numb"></A>Introduction to the LEGOCAD solver</FONT><FONT SIZE=5 COLOR="#ffffff">&nbsp;</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The core of LEGOCAD System consists of a "solver". This was the first program created in 1983; around it, have been successively created several utilities to help user during the different phases of model building and managing. On one side, these utilities provide the necessary on-line documentation to the module and on the other side they avoid the use of controls which are typical of the computer operating system.</P>
<P ALIGN="JUSTIFY">As all modular codes, the building of a model, which is solved by the solver, requires the aggregation of modules consisting of models concerning different plant components.</P>
<P ALIGN="JUSTIFY">One of the LEGOCAD basic purposes, is to reduce the heaviness of such aggregation so that it only depends on topological informations provided by user. In this way, waste of operator and computer time (caused by the need to make compatible independent mathematical models developed by different operators with different times) is eliminated.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>The modules and their aggregation</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">A module is the mathematical model of a general physical subsystem which represents a plant component (valve, pump, motor, heater, etc.), or a process physical phenomenon (fluids mixing, storage of energy, metal heat conduction, etc.). It is essentially formed by one non linear system of differential algebraic equations which depend on input variables vector, output variables vectors both algebraic and differential (states) and physical and geometrical parameters vector.</P>
<P ALIGN="JUSTIFY">Besides to characterize a specific module, input and output variables serve to carry out the topological links between different modules forming a model. The link of two modules is carried out assigning, to the output variables of one module and to the input variables of the other one, equal alphanumeric symbols (see fig.1 and 2). With LEGOCAD, this operation is easily carried out selecting the two variables to link from two lists in which input and output variables related to the modules and equipped with their physical meaning are present.</P>
<P ALIGN="JUSTIFY">&nbsp;</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image15.gif" WIDTH=507 HEIGHT=197></P>
<FONT FACE="Arial, helvetica"><P ALIGN="CENTER">figure 1: example of boiling column with n cells (simplified)</P>
<P ALIGN="CENTER">&nbsp;</P>
</FONT><P ALIGN="CENTER"><IMG SRC="image16.gif" WIDTH=377 HEIGHT=418></P>
<FONT FACE="Arial, helvetica"><P ALIGN="CENTER">figure 2: example of link between boiling column model and pipe metal model with n cells (simplified)</P>
<P ALIGN="CENTER">&nbsp;</P>
<P ALIGN="JUSTIFY">One of the characterizing and qualifying aspects of LEGOCAD as "modular" system, is the possibility that user has to develop the mathematical models library to meet his own use requirements without to be compelled to change the solver which "assembles" and "solves" the resulting models.</P>
<P ALIGN="JUSTIFY">Besides, to differentiate LEGOCAD from other systems, this aspect allows an uniform and coordinate development of application-oriented engineering of the software.</P>
<P ALIGN="JUSTIFY">Furthermore, the modules library allows a more efficiency in testing new modules developed by user.</P>
<P ALIGN="JUSTIFY">When the user has to study new plants, the inalterability of solver makes it reliable, from an algorithmic point of view, and allows to focus on modelling and application problems without worries due to the numerical calculation.</P>
<P ALIGN="JUSTIFY">From software point of view, each module is carried out in FORTRAN programming language and consists of almost three subprograms whose names are respectively characterized by I2, I3 and C1 suffixes. During different phases, they are recalled by solver, to fulfil the following functions:</P>
<P ALIGN="JUSTIFY">I3:&#9;To automatically generate the module input and output variable names, so that they are univocal inside whole model.</P>
<P ALIGN="JUSTIFY">I2:&#9;To acquire the physical and geometrical data related to the module.</P>
<P ALIGN="JUSTIFY">C1:&#9;To calculate, at every time step, the module dynamics development in relation to assigned values of the input/output variables. </P>
<P ALIGN="JUSTIFY">The calculated quantities are:</P>
<P ALIGN="JUSTIFY">a)&#9;the derivatives as regards to the time</P>
<P ALIGN="JUSTIFY">b)&#9;the algebraic function residuals</P>
<P ALIGN="JUSTIFY">c)&#9;the Jacobian matrix.</P>
<P ALIGN="JUSTIFY">This management gives to the modules the following characteristics:</P>
<P ALIGN="JUSTIFY">a) &#9;Software easiness and readability. Each of the three different types of subroutine performs different and well identified tasks and only &#9;the C1 type subroutines are assigned to the computation.</P>
<P ALIGN="JUSTIFY">b) &#9;Generality. Each module is realized to modelize a particular plant component, but it is independent from specific data which define it &#9;in a given system. So, a single module can be used both for different components concerning the same process and similar &#9;components related to different processes.</P>
<P ALIGN="JUSTIFY">c) &#9;Reliability. It is a consequence of the two previous characteristics, of the modules software standardization and of the function tests &#9;included in the solver which makes easy the debugging of a new module.</P>
<P ALIGN="JUSTIFY">When user has to build one own module, a procedure made available from LEGOCAD, automatically builds the above mentioned subprograms. That is carried out both on the basis of number and physical meaning related to input/output variables provided by user and from the constant data that module needs. The user has only to complete the subprograms feeding in C1 the expression related to his own equations.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>The LEGOCAD solver structure</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The LEGOCAD solver, also implemented in FORTRAN programming language, allows to build a plant mathematical model assembling the descriptive modules related to single components in order to calculate permanent or transient conditions as consequence of perturbations having any amplitude. This is carried out through different phases on the basis of data provided by the user supported by the LEGOCAD utilities:</P>
<P ALIGN="JUSTIFY">Phase 1) Acquisition of topological data describing the links among the model modules. This phase produces two files: the first one includes the model topology and the second one includes the symbols of the physical and geometrical data necessary to the modules. To these symbols, user has to successively assign numerical values.</P>
<P ALIGN="JUSTIFY">Phase 2) Acquisition and control on physical and geometrical data and calculation of the stationary condition consistent with the data chosen by user.</P>
<P ALIGN="JUSTIFY">The equation systems related to different modules which form the model are assembled and organized according to the defined topology.</P>
<P ALIGN="JUSTIFY">The solver builds the total system of algebraic and differential equations describing the whole mathematical model. Input variables of the total system are the modules input variables. They do not correspond to the modules output variables.</P>
<P ALIGN="JUSTIFY">In stationary condition calculation, the user has to specify what model variables are known and to provide their values (together with the tentative values) for the remaining ones. The stationary state is calculated solving the non linear system of algebraic equations which is obtained from the total system imposing as null the derivatives as regards to the time.</P>
<P ALIGN="JUSTIFY">Phase 3) Acquisition of data defining the events to simulate and step by step calculation of the transient condition. In this phase, the user specifies the model variable to perturb, the time interval and the integration final time to adopt, and what are the variables to store on file for carrying out the analysis of the results.</P>
<P ALIGN="JUSTIFY">Through the permanent files, the different phases shares the information about the model topology and the physical and geometrical characteristics.</P>
<P ALIGN="JUSTIFY">To each of these phases corresponds a feasible program which is obtained linking the solver correspondent subroutines with those of the modules included in the considered model. The solver is linked to the modules library by "hinge" subprograms automatically carried out on the basis of the model topological data. Practically, through the topology, a solver subprogram identifies what are the modules used in a given model and realizes the "hinge" subprogram in FORTRAN language. This one include the calls to the calculation subroutines of the corresponding modules. Through the use of the "hinge" subprograms, the solver proves unchanged to the variation of the application or used modules, whereas the feasible ones are generally different among themselves.</P>
</FONT><B><FONT FACE="Arial, helvetica" SIZE=4><P>&nbsp;</P>
<P>Numerical aspects</P>
</B></FONT><FONT FACE="Arial, helvetica"><P ALIGN="JUSTIFY">The general modelling approach adopted in the LEGOCAD model library is those named "with concentrated parameters" where the process physical description is included in a system of common differential equations, in the time independent variable and in a system of algebraic equations.</P>
<P ALIGN="JUSTIFY">In the thermohydraulic field the models "with concentrated parameters" gives satisfactory results provided that a suitable engineering criteria be adopted in choosing the space discretization on the basis of which the integration is done.</P>
<P ALIGN="JUSTIFY">The common differential equations forming the modules are discretized by the trapezium implicit formula and solved by integration step by step.</P>
<P ALIGN="JUSTIFY">The algebraic and differential equations concerning the mathematical model are simultaneously solved by the Newton Raphson method "damped" using an efficient algorithm for the solution of scattered systems </FONT><A HREF="legoroot.htm#lg_biblio_2"><U><FONT COLOR="#0000ff">[2]</U></FONT></A><FONT FACE="Arial, helvetica">.</P>
<P ALIGN="JUSTIFY">One of the aspects of the integration method used in the LEGOCAD solver which is useful to point out, concerns its sturdiness and stability which allows to limit errors within a precision assigned by the user. That, makes possible to determine the amplitude of integration time interval only by means physical and non numerical evaluations.</P>
<P ALIGN="JUSTIFY">So, the LEGOCAD solver allows to deal with problems characterized by the contemporary presence of time constants very fast and very slow (stiffness), as well as algebraic "loops". It is particularly efficient for high order systems but with not many links among variables.</P></FONT></BODY>
</HTML>
